<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.3. 视频输入 &mdash; X3 用户手册 1.0.1 文档</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/horizon_theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/horizon.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/hobot.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="5.4. ISP图像系统" href="4-Graphic_System_API_Reference_Manual.html" />
    <link rel="prev" title="5.2. 系统控制" href="2-System_Control_zh_CN.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> X3 用户手册
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../preface/index.html">1. 前言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/index.html">2. 快速入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/index.html">3. Demo使用指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bsp_develop/index.html">4. BSP开发指南</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">5. 多媒体开发指南</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-Overview_zh_CN.html">5.1. 系统概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-System_Control_zh_CN.html">5.2. 系统控制</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.3. 视频输入</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">5.3.1. 概述</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">5.3.1.1. 概念</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id4">5.3.2. 功能描述</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">5.3.2.1. 视频输入设备</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pipe">5.3.2.2. 视频输入PIPE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">5.3.2.3. 视频物理通道</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">5.3.2.4. 绑定关系</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#api">5.3.3. API参考</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-setbus">5.3.3.1. HB_MIPI_SetBus</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-setport">5.3.3.2. HB_MIPI_SetPort</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-sensorbindserdes">5.3.3.3. HB_MIPI_SensorBindSerdes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-sensorbindmipi">5.3.3.4. HB_MIPI_SensorBindMipi</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-setextramode">5.3.3.5. HB_MIPI_SetExtraMode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-initsensor-hb-mipi-deinitsensor">5.3.3.6. HB_MIPI_InitSensor/HB_MIPI_DeinitSensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-resetsensor-hb-mipi-unresetsensor">5.3.3.7. HB_MIPI_ResetSensor/HB_MIPI_UnresetSensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-enablesensorclock-hb-mipi-disablesensorclock">5.3.3.8. HB_MIPI_EnableSensorClock/HB_MIPI_DisableSensorClock</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-setsensorclock">5.3.3.9. HB_MIPI_SetSensorClock</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-resetmipi-hb-mipi-unresetmipi">5.3.3.10. HB_MIPI_ResetMipi/HB_MIPI_UnresetMipi</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-setmipiattr">5.3.3.11. HB_MIPI_SetMipiAttr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-clear">5.3.3.12. HB_MIPI_Clear</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-readsensor">5.3.3.13. HB_MIPI_ReadSensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-writesensor">5.3.3.14. HB_MIPI_WriteSensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-getsensorinfo">5.3.3.15. HB_MIPI_GetSensorInfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-mipi-swsensorfps">5.3.3.16. HB_MIPI_SwSensorFps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setmipibinddev-hb-vin-getmipibinddev">5.3.3.17. HB_VIN_SetMipiBindDev/HB_VIN_GetMipiBindDev</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setdevattr-hb-vin-getdevattr">5.3.3.18. HB_VIN_SetDevAttr/HB_VIN_GetDevAttr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setdevattrex-hb-vin-getdevattrex">5.3.3.19. HB_VIN_SetDevAttrEx/HB_VIN_GetDevAttrEx</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-enabledev-hb-vin-disabledev">5.3.3.20. HB_VIN_EnableDev/HB_VIN_DisableDev</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-destroydev">5.3.3.21. HB_VIN_DestroyDev</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setdevbindpipe-hb-vin-getdevbindpipe">5.3.3.22. HB_VIN_SetDevBindPipe/HB_VIN_GetDevBindPipe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-createpipe-hb-vin-destroypipe">5.3.3.23. HB_VIN_CreatePipe/HB_VIN_DestroyPipe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-startpipe-hb-vin-stoppipe">5.3.3.24. HB_VIN_StartPipe/HB_VIN_StopPipe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-enablechn-hb-vin-disablechn">5.3.3.25. HB_VIN_EnableChn/HB_VIN_DisableChn</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setchnldcattr-hb-vin-getchnldcattr">5.3.3.26. HB_VIN_SetChnLDCAttr/HB_VIN_GetChnLDCAttr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setchndisattr-hb-vin-getchndisattr">5.3.3.27. HB_VIN_SetChnDISAttr/HB_VIN_GetChnDISAttr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setchnattr">5.3.3.28. HB_VIN_SetChnAttr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-destroychn">5.3.3.29. HB_VIN_DestroyChn</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-getchnframe-hb-vin-releasechnframe">5.3.3.30. HB_VIN_GetChnFrame/HB_VIN_ReleaseChnFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-getdevframe-hb-vin-releasedevframe">5.3.3.31. HB_VIN_GetDevFrame/HB_VIN_ReleaseDevFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-sendpiperaw">5.3.3.32. HB_VIN_SendPipeRaw</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setpipeattr-hb-vin-getpipeattr">5.3.3.33. HB_VIN_SetPipeAttr/HB_VIN_GetPipeAttr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-ctrlpipemirror">5.3.3.34. HB_VIN_CtrlPipeMirror</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-motiondetect">5.3.3.35. HB_VIN_MotionDetect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-initlens">5.3.3.36. HB_VIN_InitLens</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-deinitlens">5.3.3.37. HB_VIN_DeinitLens</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-registerdiscallback">5.3.3.38. HB_VIN_RegisterDisCallback</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setdevvcnumber-hb-vin-getdevvcnumber">5.3.3.39. HB_VIN_SetDevVCNumber/HB_VIN_GetDevVCNumber</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-adddevvcnumber">5.3.3.40. HB_VIN_AddDevVCNumber</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-setdevmclk">5.3.3.41. HB_VIN_SetDevMclk</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-getchnfd">5.3.3.42. HB_VIN_GetChnFd</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-closefd">5.3.3.43. HB_VIN_CloseFd</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-enabledevmd">5.3.3.44. HB_VIN_EnableDevMd</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vin-disabledevmd">5.3.3.45. HB_VIN_DisableDevMd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">5.3.4. 数据结构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mipi-input-mode-e">5.3.4.1. MIPI_INPUT_MODE_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mipi-sensor-mode-e">5.3.4.2. MIPI_SENSOR_MODE_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mipi-deserial-info-t">5.3.4.3. MIPI_DESERIAL_INFO_T</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mipi-sns-info-s">5.3.4.4. MIPI_SNS_INFO_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mipi-sensor-info-s">5.3.4.5. MIPI_SENSOR_INFO_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mipi-host-cfg-s">5.3.4.6. MIPI_HOST_CFG_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mipi-attr-s">5.3.4.7. MIPI_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mipi-spi-data-s">5.3.4.8. MIPI_SPI_DATA_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dev-size-s">5.3.4.9. VIN_DEV_SIZE_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-mipi-attr-s">5.3.4.10. VIN_MIPI_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dev-input-ddr-attr-s">5.3.4.11. VIN_DEV_INPUT_DDR_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dev-output-ddr-s">5.3.4.12. VIN_DEV_OUTPUT_DDR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dev-output-isp-s">5.3.4.13. VIN_DEV_OUTPUT_ISP_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dev-attr-s">5.3.4.14. VIN_DEV_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dev-attr-ex-s">5.3.4.15. VIN_DEV_ATTR_EX_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-pipe-sensor-mode-e">5.3.4.16. VIN_PIPE_SENSOR_MODE_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-pipe-cfa-pattern-e">5.3.4.17. VIN_PIPE_CFA_PATTERN_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-pipe-size-s">5.3.4.18. VIN_PIPE_SIZE_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-pipe-calib-s">5.3.4.19. VIN_PIPE_CALIB_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-pipe-attr-s">5.3.4.20. VIN_PIPE_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-ldc-path-sel-s">5.3.4.21. VIN_LDC_PATH_SEL_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-ldc-picsize-s">5.3.4.22. VIN_LDC_PICSIZE_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-ldc-algoparam-s">5.3.4.23. VIN_LDC_ALGOPARAM_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-ldc-off-shift-s">5.3.4.24. VIN_LDC_OFF_SHIFT_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-ldc-woi-s">5.3.4.25. VIN_LDC_WOI_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-ldc-attr-s">5.3.4.26. VIN_LDC_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dis-picsize-s">5.3.4.27. VIN_DIS_PICSIZE_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dis-path-sel-s">5.3.4.28. VIN_DIS_PATH_SEL_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dis-crop-s">5.3.4.29. VIN_DIS_CROP_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dis-callback-s">5.3.4.30. VIN_DIS_CALLBACK_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dis-mv-info-s">5.3.4.31. VIN_DIS_MV_INFO_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-dis-attr-s">5.3.4.32. VIN_DIS_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-lens-func-type-e">5.3.4.33. VIN_LENS_FUNC_TYPE_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-lens-ctrl-attr-s">5.3.4.34. VIN_LENS_CTRL_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vin-lens-motor-type-e">5.3.4.35. VIN_LENS_MOTOR_TYPE_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-type">5.3.4.36. DATA TYPE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sif-mclk">5.3.4.37. SIF MCLK</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vpu-clk">5.3.4.38. VPU CLK</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id9">5.3.5. 错误码</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">5.3.6. 参考代码</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="4-Graphic_System_API_Reference_Manual.html">5.4. ISP图像系统</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-Video_Processing_zh_CN.html">5.5. 视频处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-Region_Processing_zh_CN.html">5.6. 区域处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="7-Video_Output_zh_CN.html">5.7. 视频输出</a></li>
<li class="toctree-l2"><a class="reference internal" href="8-Video_Encode_zh_CN.html">5.8. 视频编码</a></li>
<li class="toctree-l2"><a class="reference internal" href="9-Video_Decode_zh_CN.html">5.9. 视频解码</a></li>
<li class="toctree-l2"><a class="reference internal" href="10-ISP_Tuning_Guide/index.html">5.10. 图像调试指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="11-Image_Media_Module_Debugging_Guide/MU-2520-11-X3J3_Image_Media_Module_Debugging_Guide_zh_CN.html">5.11. 查询多媒体模块调试信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="12-Media_Processing_Performance_Debug_Guide.html">5.12. 多媒体性能调试</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ai_toolchain_develop/index.html">6. 量化工具链开发指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pc_tools/index.html">7. PC工具使用指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQs/index.html">8. FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feedback.html">9. 建议反馈</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">X3 用户手册</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">5. </span>多媒体开发指南</a> &raquo;</li>
      <li><span class="section-number">5.3. </span>视频输入</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="2-System_Control_zh_CN.html" class="btn btn-neutral float-left" title="5.2. 系统控制" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="4-Graphic_System_API_Reference_Manual.html" class="btn btn-neutral float-right" title="5.4. ISP图像系统" accesskey="n">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1><span class="section-number">5.3. </span>视频输入<a class="headerlink" href="#id1" title="永久链接至标题"></a></h1>
<section id="id2">
<h2><span class="section-number">5.3.1. </span>概述<a class="headerlink" href="#id2" title="永久链接至标题"></a></h2>
<p>视频输入（VIN）实现的功能：通过 MIPI Rx接口接收视频数据。VIN将接收到的数据给下一个模块VPS，同时也可存入到指定的内存区域，在此过程中，VIN可以对接收到的原始视频图像数据进行处理，实现视频数据的采集。</p>
<section id="id3">
<h3><span class="section-number">5.3.1.1. </span>概念<a class="headerlink" href="#id3" title="永久链接至标题"></a></h3>
<p>视频输入设备 视频输入设备主要是指sif，图像数据接口，主要功能接收摄像头模组输出的图像数据，经过offline或者online直接输出到ISP模块进行图像处理。</p>
<ul class="simple">
<li><p>视频输入设备</p></li>
</ul>
<p>​		视频输入设备主要是指sif，图像数据接口，主要功能接收摄像头模组输出的图像数据，经过offline或者		 		online直接输出到ISP模块进行图像处理。</p>
<ul class="simple">
<li><p>视频输入 PIPE</p></li>
</ul>
<p>​		视频输入 PIPE (ISP)绑定在设备后端，负责图像处理，硬核功能配置，支持Multi context。</p>
<ul class="simple">
<li><p>镜头畸变校正（LDC）</p></li>
</ul>
<p>​		主要负责矫正图像，有时因为镜头曲面造成的图像变形，一些低端镜头容易产生图像畸变，需要根据畸变程		度对其图像进行校正。</p>
<ul class="simple">
<li><p>DIS</p></li>
</ul>
<p>​		DIS 模块通过比较当前图像与前两帧图像采用不同自由度的防抖算法计算出当前图像在各个轴方向上的抖动偏		移向量，然后根据抖动偏移向量对当前图像进行校正，从而起到防抖的效果。</p>
<ul class="simple">
<li><p>DWE</p></li>
</ul>
<p>​		DWE主要是将LDC和DIS集成在一起，包括LDC的畸变矫正和DIS的统计结果。</p>
</section>
</section>
<section id="id4">
<h2><span class="section-number">5.3.2. </span>功能描述<a class="headerlink" href="#id4" title="永久链接至标题"></a></h2>
<p>VIN在软件上划分4个部分，如下图所示。</p>
<p><img alt="image-20220329195124946" src="../_images/image-20220329195124946.png" /></p>
<section id="id5">
<h3><span class="section-number">5.3.2.1. </span>视频输入设备<a class="headerlink" href="#id5" title="永久链接至标题"></a></h3>
<p>sif主要功能接收摄像头模组输出的图像数据，经过offline或者online直接输出到ISP模块进行图像处理。Mipi:支持RAW8/RAW10/RAW12/RAW14/RAW16 or YUV422 8bit/10bit。DVP interface: RAW8/RAW10/RAW12/RAW14/RAW16 or YUV422 8bit/10bit。最多支持8路sensor接入。</p>
</section>
<section id="pipe">
<h3><span class="section-number">5.3.2.2. </span>视频输入PIPE<a class="headerlink" href="#pipe" title="永久链接至标题"></a></h3>
<p>Isp主要负责图像处理，硬核功能配置，支持Multi context，最多支持8路接入。主要是对图像数据进行流水线处理，输出YUV 图像格式给通道。同时PIPE也包括DIS、LDC的功能。</p>
</section>
<section id="id6">
<h3><span class="section-number">5.3.2.3. </span>视频物理通道<a class="headerlink" href="#id6" title="永久链接至标题"></a></h3>
<p>VIN的PIPE 包含 2 个物理通道，物理通道0是指isp处理后的数据到ddr，或者是通过ddr给到下一级模块VPS。物理通道1是指isp处理后的数据online到VPS，VIN和VPS的绑定关系请参考“系统控制”章节。</p>
</section>
<section id="id7">
<h3><span class="section-number">5.3.2.4. </span>绑定关系<a class="headerlink" href="#id7" title="永久链接至标题"></a></h3>
<p>VIN和VPS之间的绑定关系请参考“系统控制”章节 HB_SYS_SetVINVPSMode</p>
</section>
</section>
<section id="api">
<h2><span class="section-number">5.3.3. </span>API参考<a class="headerlink" href="#api" title="永久链接至标题"></a></h2>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span>int HB_MIPI_SetBus(MIPI_SENSOR_INFO_S *snsInfo, uint32_t busNum);
int HB_MIPI_SetPort(MIPI_SENSOR_INFO_S *snsInfo, uint32_t port);
int HB_MIPI_SensorBindSerdes(MIPI_SENSOR_INFO_S *snsInfo, uint32_t serdesIdx, uint32_t serdesPort);
int HB_MIPI_SensorBindMipi(MIPI_SENSOR_INFO_S *snsInfo, uint32_t mipiIdx);
int HB_MIPI_SetExtraMode(MIPI_SENSOR_INFO_S *snsInfo, uint32_t ExtraMode);
int HB_MIPI_InitSensor (uint32_t DevId, MIPI_SENSOR_INFO_S  *snsInfo);
int HB_MIPI_DeinitSensor (uint32_t  DevId);
int HB_MIPI_ResetSensor(uint32_t DevId);
int HB_MIPI_UnresetSensor(uint32_t DevId);
int HB_MIPI_EnableSensorClock(uint32_t mipiIdx);
int HB_MIPI_DisableSensorClock(uint32_t mipiIdx);
int HB_MIPI_SetSensorClock(uint32_t mipiIdx, uint32_t snsMclk);
int HB_MIPI_ResetMipi(uint32_t  mipiIdx);
int HB_MIPI_UnresetMipi(uint32_t  mipiIdx);
int HB_MIPI_SetMipiAttr(uint32_t  mipiIdx, MIPI_ATTR_S  mipiAttr);
int HB_MIPI_Clear(uint32_t  mipiIdx);
int HB_MIPI_ReadSensor(uint32_t devId, uint32_t regAddr, char *buffer, uint32_t size);
int HB_MIPI_WriteSensor (uint32_t devId, uint32_t regAddr, char *buffer, uint32_t size);
int HB_MIPI_GetSensorInfo(uint32_t devId, MIPI_SENSOR_INFO_S *snsInfo);
int HB_MIPI_SwSensorFps(uint32_t devId, uint32_t fps);
int HB_VIN_SetMipiBindDev(uint32_t devId, uint32_t mipiIdx);
int HB_VIN_GetMipiBindDev(uint32_t devId, uint32_t *mipiIdx);
int HB_VIN_SetDevAttr(uint32_t devId,  const VIN_DEV_ATTR_S *stVinDevAttr);
int HB_VIN_GetDevAttr(uint32_t devId, VIN_DEV_ATTR_S *stVinDevAttr);
int HB_VIN_SetDevAttrEx(uint32_t devId,  const VIN_DEV_ATTR_EX_S *stVinDevAttrEx);
int HB_VIN_GetDevAttrEx(uint32_t devId, VIN_DEV_ATTR_EX_S *stVinDevAttrEx);
int HB_VIN_EnableDev(uint32_t devId);
int HB_VIN_DisableDev (uint32_t devId);
int HB_VIN_DestroyDev(uint32_t devId);
int HB_VIN_SetDevBindPipe(uint32_t devId, uint32_t pipeId);
int HB_VIN_GetDevBindPipe(uint32_t devId, uint32_t *pipeId);
int HB_VIN_CreatePipe(uint32_t pipeId, const VIN_PIPE_ATTR_S * stVinPipeAttr);
int HB_VIN_DestroyPipe(uint32_t pipeId);
int HB_VIN_StartPipe(uint32_t pipeId);
int HB_VIN_StopPipe(uint32_t pipeId);
int HB_VIN_EnableChn(uint32_t pipeId, uint32_t chnId);
int HB_VIN_DisableChn(uint32_t pipeId, uint32_t chnId);
int HB_VIN_SetChnLDCAttr(uint32_t pipeId, uint32_t chnId,const VIN_LDC_ATTR_S *stVinLdcAttr);
int HB_VIN_GetChnLDCAttr(uint32_t pipeId, uint32_t chnId, VIN_LDC_ATTR_S*stVinLdcAttr);
int HB_VIN_SetChnDISAttr(uint32_t pipeId, uint32_t chnId, const VIN_DIS_ATTR_S *stVinDisAttr);
int HB_VIN_GetChnDISAttr(uint32_t pipeId, uint32_t chnId, VIN_DIS_ATTR_S *stVinDisAttr);
int HB_VIN_SetChnAttr(uint32_t pipeId, uint32_t chnId);
int HB_VIN_DestroyChn(uint32_t pipeId, uint32_t chnId);
int HB_VIN_GetChnFrame(uint32_t pipeId, uint32_t chnId, void *pstVideoFrame, int32_t millSec);
int HB_VIN_ReleaseChnFrame(uint32_t pipeId, uint32_t chnId, void *pstVideoFrame);
int HB_VIN_SendPipeRaw(uint32_t pipeId, void *pstVideoFrame，int32_t millSec);
int HB_VIN_SetPipeAttr(uint32_t pipeId,VIN_PIPE_ATTR_S *stVinPipeAttr);
int HB_VIN_GetPipeAttr(uint32_t pipeId, VIN_PIPE_ATTR_S *stVinPipeAttr);
int HB_VIN_CtrlPipeMirror(uint32_t pipeId, uint8_t on);
int HB_VIN_MotionDetect(uint32_t pipeId);
int HB_VIN_InitLens(uint32_t pipeId, VIN_LENS_FUNC_TYPE_ElensType,const VIN_LENS_CTRL_ATTR_S *lenCtlAttr);
int HB_VIN_DeinitLens(uint32_t pipeId);
int HB_VIN_RegisterDisCallback(uint32_t pipeId,VIN_DIS_CALLBACK_S *pstDISCallback);
int HB_VIN_SetDevVCNumber(uint32_t devId, uint32_t vcNumber);
int HB_VIN_GetDevVCNumber(uint32_t devId, uint32_t *vcNumber);
int HB_VIN_AddDevVCNumber(uint32_t devId, uint32_t vcNumber);
int HB_VIN_SetDevMclk(uint32_t devId, uint32_t devMclk, uint32_t vpuMclk);
int HB_VIN_GetChnFd(uint32_t pipeId, uint32_t chnId);
int HB_VIN_CloseFd(void);
int HB_VIN_EnableDevMd(uint32_t devId);
int HB_VIN_DisableDevMd(uint32_t devId);
int HB_VIN_GetDevFrame(uint32_t devId, uint32_t chnId, void *videoFrame, int32_t millSec);
int HB_VIN_ReleaseDevFrame(uint32_t devId, uint32_t chnId, void *buf);
</pre></div>
</div>
<section id="hb-mipi-setbus">
<h3><span class="section-number">5.3.3.1. </span>HB_MIPI_SetBus<a class="headerlink" href="#hb-mipi-setbus" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_SetBus</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w"> </span><span class="o">*</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">busNum</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置sensor的总线号</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">snsInfo</td>
<td align="center">sensor的配置信息</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">busNum</td>
<td align="center">bus号</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor/HB_MIPI_DeinitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-setport">
<h3><span class="section-number">5.3.3.2. </span>HB_MIPI_SetPort<a class="headerlink" href="#hb-mipi-setport" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_SetPort</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w"> </span><span class="o">*</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">port</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置sensor的port，取值范围 0~7</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">snsInfo</td>
<td align="center">sensor的配置信息</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">port</td>
<td align="center">当前sensor的port号，0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor/HB_MIPI_DeinitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-sensorbindserdes">
<h3><span class="section-number">5.3.3.3. </span>HB_MIPI_SensorBindSerdes<a class="headerlink" href="#hb-mipi-sensorbindserdes" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_SensorBindSerdes</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w"> </span><span class="o">*</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">serdesIdx</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">serdesPort</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置sensor绑定到哪个serdes上</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">snsInfo</td>
<td align="center">sensor的配置信息</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">serdesIdx</td>
<td align="center">serdes的索引0~1</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">serdesPort</td>
<td align="center">serdes的port号954 0~1  960 0~3</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor/HB_MIPI_DeinitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-sensorbindmipi">
<h3><span class="section-number">5.3.3.4. </span>HB_MIPI_SensorBindMipi<a class="headerlink" href="#hb-mipi-sensorbindmipi" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_SensorBindMipi</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w"> </span><span class="o">*</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">mipiIdx</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置sensor绑定哪一个mipi上</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">snsInfo</td>
<td align="center">sensor的配置信息</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">mipiIdx</td>
<td align="center">mipi_host的索引 0~3</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-setextramode">
<h3><span class="section-number">5.3.3.5. </span>HB_MIPI_SetExtraMode<a class="headerlink" href="#hb-mipi-setextramode" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_SetExtraMode</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w"> </span><span class="o">*</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ExtraMode</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置sensor在DOL2或DOL3下的工作模式</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="left">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">snsInfo</td>
<td align="center">sensor的配置信息</td>
<td align="left">输入</td>
</tr>
<tr>
<td align="center">ExtraMode</td>
<td align="center">选择以何种工作模式</td>
<td align="left">1. 单路DOL2,值为0<br /> 2. DOL2分为两路linear,一路值为1，另一路值为2<br /> 3. 单路DOl3,值为0<br /> 4. 一路DOl2(值为1)+一路linear(值为4)<br /> 5. DOL3分为三路linear,一路为2，一路为3，一路为4</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor/HB_MIPI_DeinitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-initsensor-hb-mipi-deinitsensor">
<h3><span class="section-number">5.3.3.6. </span>HB_MIPI_InitSensor/HB_MIPI_DeinitSensor<a class="headerlink" href="#hb-mipi-initsensor-hb-mipi-deinitsensor" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_InitSensor</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">DevId</span><span class="p">,</span><span class="w"> </span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w">  </span><span class="o">*</span><span class="n">snsInfo</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_DeinitSensor</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>sensor的初始化和释放初始化产生的资源</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">通路索引，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">snsInfo</td>
<td align="center">Sensor 信息</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w">  </span><span class="n">snsInfo</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_ATTR_S</span><span class="w">  </span><span class="n">mipiAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">DevId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">mipiIdx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">serdes_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">serdes_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ExtraMode</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">mipiAttr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">MIPI_ATTR_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">bus_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">bus_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">entry_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">sensor_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;imx327&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">reg_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">sensor_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NORMAL_M</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">sensor_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x36</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">dev_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">lane</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">datatype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x2c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">mclk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">mipiclk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">891</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">fps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1952</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1097</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="o">-&gt;</span><span class="n">linelenth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2475</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="o">-&gt;</span><span class="n">framelenth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1200</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="o">-&gt;</span><span class="n">settle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">HB_MIPI_SetBus</span><span class="p">(</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="n">bus</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_SetPort</span><span class="p">(</span><span class="n">snsinfo</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_SensorBindSerdes</span><span class="p">(</span><span class="n">snsinfo</span><span class="p">,</span><span class="w"> </span><span class="n">sedres_index</span><span class="p">,</span><span class="w"> </span><span class="n">sedres_port</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_SensorBindMipi</span><span class="p">(</span><span class="n">snsinfo</span><span class="p">,</span><span class="w">  </span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_SetExtraMode</span><span class="w"> </span><span class="p">(</span><span class="n">snsinfo</span><span class="p">,</span><span class="w">  </span><span class="n">ExtraMode</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_InitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="p">,</span><span class="w"> </span><span class="n">snsInfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_InitSensor error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_SetMipiAttr</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">,</span><span class="w"> </span><span class="n">mipiAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_SetMipiAttr error! do sensorDeinit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_SensorDeinit</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_ResetSensor</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_ResetSensor error! do mipi deinit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_ResetMipi</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_ResetMipi error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_UnresetSensor</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_UnresetSensor</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_UnresetMipi</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-mipi-resetsensor-hb-mipi-unresetsensor">
<h3><span class="section-number">5.3.3.7. </span>HB_MIPI_ResetSensor/HB_MIPI_UnresetSensor<a class="headerlink" href="#hb-mipi-resetsensor-hb-mipi-unresetsensor" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_ResetSensor</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_UnresetSensor</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>sensor数据流的打开和关闭,sensor_start/sensor_stop</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">通路索引，范围0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor/HB_MIPI_DeinitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-enablesensorclock-hb-mipi-disablesensorclock">
<h3><span class="section-number">5.3.3.8. </span>HB_MIPI_EnableSensorClock/HB_MIPI_DisableSensorClock<a class="headerlink" href="#hb-mipi-enablesensorclock-hb-mipi-disablesensorclock" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_EnableSensorClock</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_DisableSensorClock</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>打开和关闭,sensor_clk</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">mipiIdx</td>
<td align="center">Mipi host 索引号，范围0~3</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>使用此接口需去掉子板的晶振</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-mipi-setsensorclock">
<h3><span class="section-number">5.3.3.9. </span>HB_MIPI_SetSensorClock<a class="headerlink" href="#hb-mipi-setsensorclock" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_SetSensorClock</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">mipiIdx</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">snsMclk</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置sensor_mclk
一共有4个sensor_mclk，目前用到得是sensor0_mclk和sensor1_mclk,
mipi0连接在sensor_mclk1, mipi1连接在sensor_mclk0,硬件连接关系在dts里面定义。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">mipiIdx</td>
<td align="center">Mipi host 索引号，范围0~3</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">snsMclk</td>
<td align="center">单位HZ</td>
<td align="center">输入，比如24MHZ，snsMclk为24000000</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>使用此接口需去掉子板的晶振</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>初始化时:</p>
<blockquote>
<div><p>先设置sensor_mclk然后再去使能
HB_MIPI_SetSensorClock(mipiIdx, 24000000);
HB_MIPI_EnableSensorClock(mipiIdx);</p>
</div></blockquote>
</div></blockquote>
<blockquote>
<div><p>退出时：</p>
<blockquote>
<div><p>HB_MIPI_Clear(mipiIdx);
HB_MIPI_DeinitSensor(devId);
HB_MIPI_DisableSensorClock(mipiIdx);</p>
</div></blockquote>
</div></blockquote>
</section>
<section id="hb-mipi-resetmipi-hb-mipi-unresetmipi">
<h3><span class="section-number">5.3.3.10. </span>HB_MIPI_ResetMipi/HB_MIPI_UnresetMipi<a class="headerlink" href="#hb-mipi-resetmipi-hb-mipi-unresetmipi" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_ResetMipi</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_UnresetMipi</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">mipiIdx</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>mipi的start和stop</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">mipiIdx</td>
<td align="center">Mipi host 索引号，范围0~3</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor/HB_MIPI_DeinitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-setmipiattr">
<h3><span class="section-number">5.3.3.11. </span>HB_MIPI_SetMipiAttr<a class="headerlink" href="#hb-mipi-setmipiattr" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_SetMipiAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">mipiIdx</span><span class="p">,</span><span class="w"> </span><span class="n">MIPI_ATTR_S</span><span class="w">  </span><span class="n">mipiAttr</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置mipi的属性，host和dev的初始化。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">mipiIdx</td>
<td align="center">Mipi host 索引号</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">mipiAttr</td>
<td align="center">Mipi总线属性信息</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor/HB_MIPI_DeinitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-clear">
<h3><span class="section-number">5.3.3.12. </span>HB_MIPI_Clear<a class="headerlink" href="#hb-mipi-clear" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_MIPI_Clear</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>清除设备相关的配置，mipi host/dev 的deinit，和接口HB_MIPI_SetMipiAttr对应。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">mipiIdx</td>
<td align="center">Mipi host 索引号，范围0~3</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_InitSensor/HB_MIPI_DeinitSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-readsensor">
<h3><span class="section-number">5.3.3.13. </span>HB_MIPI_ReadSensor<a class="headerlink" href="#hb-mipi-readsensor" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_ReadSensor</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">regAddr</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>通过i2c读取sensor。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">通路索引，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">regAddr</td>
<td align="center">寄存器地址</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">buffer,</td>
<td align="center">存放数据的地址</td>
<td align="center">输出</td>
</tr>
<tr>
<td align="center">size</td>
<td align="center">读取的长度</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>必须在HB_MIPI_InitSensor接口调用后才能使用</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>不同的sensor不一样，以imx327为例：</p>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">0x34</span><span class="p">,</span><span class="w"> </span><span class="mh">0x56</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">rev_buffer</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_InitSensor end</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_ReadSensor</span><span class="p">(</span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3018</span><span class="p">,</span><span class="w"> </span><span class="n">rev_buffer</span><span class="p">,</span><span class="w">  </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_ReadSensor error</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">rev_buffer</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;rev_buffer[%d] 0x%x  </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">rev_buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_WriteSensor</span><span class="p">(</span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3018</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_WriteSensor error</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_ReadSensor</span><span class="p">(</span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3018</span><span class="p">,</span><span class="w"> </span><span class="n">rev_buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_ReadSensor error</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">rev_buffer</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;rev_buffer[%d] 0x%x  </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">rev_buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-mipi-writesensor">
<h3><span class="section-number">5.3.3.14. </span>HB_MIPI_WriteSensor<a class="headerlink" href="#hb-mipi-writesensor" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_WriteSensor</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">regAddr</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>通过i2c写sensor寄存器</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">通路索引，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">regAddr</td>
<td align="center">寄存器地址</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">buffer</td>
<td align="center">存放数据的地址</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">size</td>
<td align="center">写的长度</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>必须在HB_MIPI_InitSensor接口调用后才能使用</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_MIPI_ReadSensor举例</p>
</div></blockquote>
</section>
<section id="hb-mipi-getsensorinfo">
<h3><span class="section-number">5.3.3.15. </span>HB_MIPI_GetSensorInfo<a class="headerlink" href="#hb-mipi-getsensorinfo" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_GetSensorInfo</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w"> </span><span class="o">*</span><span class="n">snsInfo</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>获取sensor相关配置信息</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">通路索引，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">snsInfo</td>
<td align="center">sensor信息</td>
<td align="center">输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>必须在HB_MIPI_InitSensor接口调用后才能使用</p>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w"> </span><span class="o">*</span><span class="n">snsinfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsinfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">snsinfo</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;malloc error</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">snsinfo</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_GetSensorInfo</span><span class="p">(</span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="n">snsinfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_InitSensor error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-mipi-swsensorfps">
<h3><span class="section-number">5.3.3.16. </span>HB_MIPI_SwSensorFps<a class="headerlink" href="#hb-mipi-swsensorfps" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_MIPI_SwSensorFps</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">fps</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>切换sensor的帧率</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">通路索引，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">fps</td>
<td align="center">sensor的帧率</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>必须在HB_MIPI_InitSensor接口调用后才能使用</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-vin-setmipibinddev-hb-vin-getmipibinddev">
<h3><span class="section-number">5.3.3.17. </span>HB_VIN_SetMipiBindDev/HB_VIN_GetMipiBindDev<a class="headerlink" href="#hb-vin-setmipibinddev-hb-vin-getmipibinddev" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_SetMipiBindDev</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">mipiIdx</span><span class="p">)</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_GetMipiBindDev</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">mipiIdx</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置mipi和dev的绑定，dev使用哪一个mipi_host</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应通道索引号，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">mipiIdx</td>
<td align="center">mipi_host的索引</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-setdevattr-hb-vin-getdevattr">
<h3><span class="section-number">5.3.3.18. </span>HB_VIN_SetDevAttr/HB_VIN_GetDevAttr<a class="headerlink" href="#hb-vin-setdevattr-hb-vin-getdevattr" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_SetDevAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">VIN_DEV_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinDevAttr</span><span class="p">)</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_GetDevAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="n">VIN_DEV_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinDevAttr</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置和获取dev的属性</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应通道索引号，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">stVinDevAttr</td>
<td align="center">dev通道属性</td>
<td align="center">输入，调用HB_VIN_GetDevAttr为输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>DOL3拆分成多路时，多进程情况：第一个进程要先于第二个进程运行1秒即可。
另外目前不支持HB_VIN_DestroyDev之后重新HB_VIN_SetDevAttr。</p>
<p>出现SIF_IOC_BIND_GROUT ioctl failed报错，一般是前一次pipeid的调用没有退出，又重新调用。</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-setdevattrex-hb-vin-getdevattrex">
<h3><span class="section-number">5.3.3.19. </span>HB_VIN_SetDevAttrEx/HB_VIN_GetDevAttrEx<a class="headerlink" href="#hb-vin-setdevattrex-hb-vin-getdevattrex" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_SetDevAttrEx</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">VIN_DEV_ATTR_EX_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinDevAttrEx</span><span class="p">)</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_GetDevAttrEx</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="n">VIN_DEV_ATTR_EX_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinDevAttrEx</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置何获取dev的扩展属性</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应通道索引号，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">stVinDevAttrEx</td>
<td align="center">dev的扩展属性</td>
<td align="center">输入，调用HB_VIN_GetDevAttr为输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>该接口暂不支持</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-vin-enabledev-hb-vin-disabledev">
<h3><span class="section-number">5.3.3.20. </span>HB_VIN_EnableDev/HB_VIN_DisableDev<a class="headerlink" href="#hb-vin-enabledev-hb-vin-disabledev" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_EnableDev</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_DisableDev</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>dev模块的使能和关闭</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-destroydev">
<h3><span class="section-number">5.3.3.21. </span>HB_VIN_DestroyDev<a class="headerlink" href="#hb-vin-destroydev" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>dev模块的销毁，资源释放</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-setdevbindpipe-hb-vin-getdevbindpipe">
<h3><span class="section-number">5.3.3.22. </span>HB_VIN_SetDevBindPipe/HB_VIN_GetDevBindPipe<a class="headerlink" href="#hb-vin-setdevbindpipe-hb-vin-getdevbindpipe" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_SetDevBindPipe</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">)</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_GetDevBindPipe</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">pipeId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置dev的chn输出和pipe的chn输入的绑定
设置pipe的chn输入和pipe输出的chn绑定。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，同上</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>HB_VIN_GetDevBindPipe接口暂未实现</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-createpipe-hb-vin-destroypipe">
<h3><span class="section-number">5.3.3.23. </span>HB_VIN_CreatePipe/HB_VIN_DestroyPipe<a class="headerlink" href="#hb-vin-createpipe-hb-vin-destroypipe" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_CreatePipe</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">VIN_PIPE_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">stVinPipeAttr</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>创建pipe、销毁pipe</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">stVinPipeAttr</td>
<td align="center">描述pipe属性的指针</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">VIN_DEV_ATTR_S</span><span class="w">  </span><span class="n">stVinDevAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_PIPE_ATTR_S</span><span class="w">  </span><span class="n">stVinPipeAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DIS_ATTR_S</span><span class="w">   </span><span class="n">stVinDisAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LDC_ATTR_S</span><span class="w">  </span><span class="n">stVinLdcAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_SNS_TYPE_E</span><span class="w"> </span><span class="n">sensorId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_SENSOR_INFO_S</span><span class="w">  </span><span class="n">snsInfo</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_ATTR_S</span><span class="w">  </span><span class="n">mipiAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_SNS_TYPE_E</span><span class="w"> </span><span class="n">sensorId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">PipeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">DevId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">mipiIdx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ChnId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">serdes_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">serdes_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">MIPI_SENSOR_INFO_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">mipiAttr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">MIPI_ATTR_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">stVinDevAttr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">VIN_DEV_ATTR_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">stVinPipeAttr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">VIN_PIPE_ATTR_</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">stVinDisAttr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">VIN_DIS_ATTR_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">stVinLdcAttr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">VIN_LDC_ATTR_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">bus_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">bus_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">entry_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">sensor_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;imx327&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">reg_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">sensor_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NORMAL_M</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">snsInfo</span><span class="p">.</span><span class="n">sensorInfo</span><span class="p">.</span><span class="n">sensor_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x36</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">dev_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">lane</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">datatype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x2c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">mclk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">mipiclk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">891</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">fps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1952</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1097</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="o">-&gt;</span><span class="n">linelenth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2475</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="o">-&gt;</span><span class="n">framelenth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1200</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">mipi_host_cfg</span><span class="o">-&gt;</span><span class="n">settle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">stSize</span><span class="p">.</span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">stSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1952</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">stSize</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1097</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">stSize</span><span class="p">.</span><span class="n">pix_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">ipi_channels</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">enable_frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">mipiAttr</span><span class="p">.</span><span class="n">enable_mux_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">DdrIspAttr</span><span class="p">.</span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">DdrIspAttr</span><span class="p">.</span><span class="n">buf_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">DdrIspAttr</span><span class="p">.</span><span class="n">raw_feedback_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">DdrIspAttr</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">DdrIspAttr</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1952</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">DdrIspAttr</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1907</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">DdrIspAttr</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">pix_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outIspAttr</span><span class="p">.</span><span class="n">isp_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outIspAttr</span><span class="p">.</span><span class="n">dol_exp_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outIspAttr</span><span class="p">.</span><span class="n">enable_flyby</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outDdrAttr</span><span class="p">.</span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outDdrAttr</span><span class="p">.</span><span class="n">mux_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outDdrAttr</span><span class="p">.</span><span class="n">buffer_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outDdrAttr</span><span class="p">.</span><span class="n">raw_dump_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outDdrAttr</span><span class="p">.</span><span class="n">stride</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2928</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDevAttr</span><span class="p">.</span><span class="n">outIpuAttr</span><span class="p">.</span><span class="n">enable_flyby</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">stVinPipeAttr</span><span class="p">.</span><span class="n">ddrOutBufNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinPipeAttr</span><span class="p">.</span><span class="n">pipeDmaEnable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinPipeAttr</span><span class="p">.</span><span class="n">snsMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinPipeAttr</span><span class="p">.</span><span class="n">stSize</span><span class="p">.</span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinPipeAttr</span><span class="p">.</span><span class="n">stSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1920</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinPipeAttr</span><span class="p">.</span><span class="n">stSize</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1080</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">xCrop</span><span class="p">.</span><span class="n">rg_dis_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">xCrop</span><span class="p">.</span><span class="n">rg_dis_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1919</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">yCrop</span><span class="p">.</span><span class="n">rg_dis_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">yCrop</span><span class="p">.</span><span class="n">rg_dis_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1079</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">disHratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">65536</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">disVratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">65536</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">disPath</span><span class="p">.</span><span class="n">rg_dis_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">disPath</span><span class="p">.</span><span class="n">rg_dis_path_sel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">picSize</span><span class="p">.</span><span class="n">pic_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1919</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinDisAttr</span><span class="p">.</span><span class="n">picSize</span><span class="p">.</span><span class="n">pic_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1079</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">ldcEnable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">ldcPath</span><span class="p">.</span><span class="n">rg_h_blank_cyc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">yStartAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">524288</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">cStartAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">786432</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">picSize</span><span class="p">.</span><span class="n">pic_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1919</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">picSize</span><span class="p">.</span><span class="n">pic_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1079</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">lineBuf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">xParam</span><span class="p">.</span><span class="n">rg_algo_param_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">xParam</span><span class="p">.</span><span class="n">rg_algo_param_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">yParam</span><span class="p">.</span><span class="n">rg_algo_param_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">yParam</span><span class="p">.</span><span class="n">rg_algo_param_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">xWoi</span><span class="p">.</span><span class="n">rg_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1919</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">xWoi</span><span class="p">.</span><span class="n">rg_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">yWoi</span><span class="p">.</span><span class="n">rg_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1079</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stVinLdcAttr</span><span class="o">-&gt;</span><span class="n">yWoi</span><span class="p">.</span><span class="n">rg_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_CreatePipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">,</span><span class="w"> </span><span class="n">pipeInfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_CreatePipe t error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetMipiBindDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetMipiBindDev error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetDevVCNumber</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">deseri_port</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetDevVCNumber error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetDevAttr</span><span class="p">(</span><span class="n">DevId</span><span class="p">,</span><span class="w"> </span><span class="n">devInfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetDevAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetPipeAttr</span><span class="w"> </span><span class="p">(</span><span class="n">PipeId</span><span class="p">,</span><span class="w"> </span><span class="n">pipeInfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetPipeAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetChnDISAttr</span><span class="p">(</span><span class="n">PipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">,</span><span class="w"> </span><span class="n">disInfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetChnDISAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetChnLDCAttr</span><span class="p">(</span><span class="n">PipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">,</span><span class="w"> </span><span class="n">ldcInfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetChnLDCAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetChnAttr</span><span class="p">(</span><span class="n">PipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetChnAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VIN_SetDevBindPipe</span><span class="p">(</span><span class="n">DevId</span><span class="p">,</span><span class="w"> </span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">HB_MIPI_SetBus</span><span class="p">(</span><span class="n">snsInfo</span><span class="p">,</span><span class="w"> </span><span class="n">bus</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_SetPort</span><span class="p">(</span><span class="n">snsinfo</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_SensorBindSerdes</span><span class="p">(</span><span class="n">snsinfo</span><span class="p">,</span><span class="w"> </span><span class="n">sedres_index</span><span class="p">,</span><span class="w"> </span><span class="n">sedres_port</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_SensorBindMipi</span><span class="p">(</span><span class="n">snsinfo</span><span class="p">,</span><span class="w">  </span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_InitSensor</span><span class="p">(</span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="n">snsInfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_InitSensor error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_SetMipiAttr</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">,</span><span class="w"> </span><span class="n">mipiAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_SetMipiAttr error! do sensorDeinit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_SensorDeinit</span><span class="p">(</span><span class="n">sensorId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_EnableChn</span><span class="p">(</span><span class="n">PipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_EnableChn error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_StartPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_StartPipe error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DisableChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_EnableDev</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_EnableDev error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DisableChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_StopPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_ResetSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_ResetSensor error! do mipi deinit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DisableDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_StopPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DisableChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_MIPI_ResetMipi</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_ResetMipi error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_UnresetSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DisableDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_StopPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DisableChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyChn</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">HB_MIPI_UnresetSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_UnresetMipi</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VIN_DisableDev</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VIN_StopPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VIN_DisableChn</span><span class="p">(</span><span class="n">PipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_DeinitSensor</span><span class="p">(</span><span class="n">DevId</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_MIPI_Clear</span><span class="p">(</span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VIN_DestroyDev</span><span class="p">(</span><span class="n">DevId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VIN_DestroyChn</span><span class="p">(</span><span class="n">PipeId</span><span class="p">,</span><span class="w"> </span><span class="n">ChnId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VIN_DestroyPipe</span><span class="p">(</span><span class="n">PipeId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-vin-startpipe-hb-vin-stoppipe">
<h3><span class="section-number">5.3.3.24. </span>HB_VIN_StartPipe/HB_VIN_StopPipe<a class="headerlink" href="#hb-vin-startpipe-hb-vin-stoppipe" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_StartPipe</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_StopPipe</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>启动和停止pipe</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-enablechn-hb-vin-disablechn">
<h3><span class="section-number">5.3.3.25. </span>HB_VIN_EnableChn/HB_VIN_DisableChn<a class="headerlink" href="#hb-vin-enablechn-hb-vin-disablechn" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_EnableChn</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_DisableChn</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>对pipe的chn使能和关闭</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">chnId</td>
<td align="center">输入1即可</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-setchnldcattr-hb-vin-getchnldcattr">
<h3><span class="section-number">5.3.3.26. </span>HB_VIN_SetChnLDCAttr/HB_VIN_GetChnLDCAttr<a class="headerlink" href="#hb-vin-setchnldcattr-hb-vin-getchnldcattr" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_SetChnLDCAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">,</span><span class="k">const</span><span class="w"> </span><span class="n">VIN_LDC_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinLdcAttr</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_GetChnLDCAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">,</span><span class="w"> </span><span class="n">VIN_LDC_ATTR_S</span><span class="o">*</span><span class="n">stVinLdcAttr</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置和获取LDC的属性</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">chnId</td>
<td align="center">输入1即可</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">stVinLdcAttr</td>
<td align="center">ldc的属性信息</td>
<td align="center">输入，获取属性的时候为输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>LDC有调整送往IPU数据时序的功能，在VIN_ISP与VPS模块是在线模式的情况下，必须要通过该接口配置LDC参数，否则VPS会出异常。VIN_ISP与VPS模块是离线模式LDC参数配置与否都不影响。</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-setchndisattr-hb-vin-getchndisattr">
<h3><span class="section-number">5.3.3.27. </span>HB_VIN_SetChnDISAttr/HB_VIN_GetChnDISAttr<a class="headerlink" href="#hb-vin-setchndisattr-hb-vin-getchndisattr" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_SetChnDISAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">VIN_DIS_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinDisAttr</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_GetChnDISAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">,</span><span class="w"> </span><span class="n">VIN_DIS_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinDisAttr</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置和获取DIS的属性</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">chnId</td>
<td align="center">输入1即可</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">stVinDisAttr</td>
<td align="center">dis的属性信息</td>
<td align="center">输入，获取属性的时候为输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-setchnattr">
<h3><span class="section-number">5.3.3.28. </span>HB_VIN_SetChnAttr<a class="headerlink" href="#hb-vin-setchnattr" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_SetChnAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置chn的属性</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">chnId</td>
<td align="center">输入1即可</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>LDC和DIS的属性真正设置是在这个接口里面，HB_VIN_SetChnLDCAttr和HB_VIN_SetChnDISAttr只是给属性赋值。这个chn是指isp的其中一个输出chn,值固定为1。</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-destroychn">
<h3><span class="section-number">5.3.3.29. </span>HB_VIN_DestroyChn<a class="headerlink" href="#hb-vin-destroychn" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_DestroyChn</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>销毁chn</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">chnId</td>
<td align="center">输入1即可</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>目前不支持HB_VIN_DestroyChn之后重新HB_VIN_SetChnAttr</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-getchnframe-hb-vin-releasechnframe">
<h3><span class="section-number">5.3.3.30. </span>HB_VIN_GetChnFrame/HB_VIN_ReleaseChnFrame<a class="headerlink" href="#hb-vin-getchnframe-hb-vin-releasechnframe" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_GetChnFrame</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pstVideoFrame</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">millSec</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_ReleaseChnFrame</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pstVideoFrame</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>获取pipe chn后的数据</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">chnId</td>
<td align="center">输入0即可</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstVideoFrame</td>
<td align="center">数据信息</td>
<td align="center">输出</td>
</tr>
<tr>
<td align="center">millSec</td>
<td align="center">超时参数 millSec<br/>设为-1 时，为阻塞接口；<br/>0 时为 非阻塞接口；<br/>大于 0 时为超时等待时间，<br/>超时时间的 单位为毫秒（ms）</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>此接口是获取ISP处理之后的图像</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-getdevframe-hb-vin-releasedevframe">
<h3><span class="section-number">5.3.3.31. </span>HB_VIN_GetDevFrame/HB_VIN_ReleaseDevFrame<a class="headerlink" href="#hb-vin-getdevframe-hb-vin-releasedevframe" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_GetDevFrame</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">videoFrame</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">millSec</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_ReleaseDevFrame</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>获取sif chn处理后的数据，chn为0</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">chnId</td>
<td align="center">输入0即可</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">videoFram</td>
<td align="center">数据信息</td>
<td align="center">输出</td>
</tr>
<tr>
<td align="center">millSec</td>
<td align="center">超时参数 millSec<br/>设为-1 时，为阻塞接口；<br/>0 时为 非阻塞接口；<br/>大于 0 时为超时等待时间，<br/>超时时间的 单位为毫秒（ms）</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>此接口是获取SIF处理之后的图像，sif –offline-isp得时候可以dump raw图，
适用场景：</p>
<blockquote>
<div><p>VIN_OFFLINE_VPS_ONLINE
VIN_OFFLINE_VPS_OFFINE
VIN_SIF_OFFLINE_ISP_OFFLINE_VPS_ONLINE</p>
</div></blockquote>
</div></blockquote>
<p>另外sif-online-isp 同时sif到ddr也可以dump raw图，适用场景：</p>
<blockquote>
<div><blockquote>
<div><p>VIN_SIF_ONLINE_DDR_ISP_DDR_VPS_ONLINE
VIN_SIF_ONLINE_DDR_ISP_ONLINE_VPS_ONLINE</p>
</div></blockquote>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">frame_id</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">plane_count</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">xres</span><span class="p">[</span><span class="n">MAX_PLANE</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">yres</span><span class="p">[</span><span class="n">MAX_PLANE</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">[</span><span class="n">MAX_PLANE</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">size</span><span class="p">[</span><span class="n">MAX_PLANE</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">raw_t</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ctx_id</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">raw_t</span><span class="w"> </span><span class="n">raw</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">dump_info_t</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dump_info_t</span><span class="w"> </span><span class="n">dump_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">hb_vio_buffer_t</span><span class="w"> </span><span class="o">*</span><span class="n">sif_raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pipeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">sif_raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">hb_vio_buffer_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">hb_vio_buffer_t</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">sif_raw</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">hb_vio_buffer_t</span><span class="p">));</span><span class="w"></span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_GetDevFrame</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sif_raw</span><span class="p">,</span><span class="w"> </span><span class="mi">2000</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_GetDevFrame error!!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">planeCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">ctx_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="o">-&gt;</span><span class="n">group_id</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">frame_id</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">plane_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">planeCount</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">xres</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">yres</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipe(%d)dump normal raw frame id(%d),plane(%d)size(%d)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">ctx_id</span><span class="p">,</span><span class="w"> </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">frame_id</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">plane_count</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">planeCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">ctx_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="o">-&gt;</span><span class="n">group_id</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">frame_id</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">plane_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">planeCount</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">planeCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">xres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">yres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">img_format</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipe(%d)dump dol2 raw frame id(%d),plane(%d)size(%d)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="n">dump_info</span><span class="p">.</span><span class="n">ctx_id</span><span class="p">,</span><span class="w"> </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">frame_id</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">plane_count</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">planeCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">ctx_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="o">-&gt;</span><span class="n">group_id</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">frame_id</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">plane_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">planeCount</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">planeCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">xres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">yres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">                    </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipe(%d)dump dol3 raw frame id(%d),plane(%d)size(%d)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">ctx_id</span><span class="p">,</span><span class="w"> </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">frame_id</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">plane_count</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipe(%d)raw buf planeCount wrong !!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="o">-&gt;</span><span class="n">group_id</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">plane_count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">img_format</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">sprintf</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pipe%d_plane%d_%ux%u_frame_%03d.raw&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">ctx_id</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">xres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"></span>
<span class="w">                            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">yres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"></span>
<span class="w">                            </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">frame_id</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="n">dumpToFile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="w">  </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_info</span><span class="p">.</span><span class="n">img_format</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">sprintf</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pipe%d_%ux%u_frame_%03d.yuv&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">dump_info</span><span class="p">.</span><span class="n">ctx_id</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">xres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"></span>
<span class="w">                        </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">yres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"></span>
<span class="w">                        </span><span class="n">dump_info</span><span class="p">.</span><span class="n">raw</span><span class="p">.</span><span class="n">frame_id</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="n">dumpToFile2plane</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="w"> </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"></span>
<span class="w">                    </span><span class="n">sif_raw</span><span class="o">-&gt;</span><span class="n">img_addr</span><span class="p">.</span><span class="n">addr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_ReleaseDevFrame</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sif_raw</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_ReleaseDevFrame error!!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">sif_raw</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">sif_raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">dumpToFile</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">srcBuf</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">yuvFd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">yuvFd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;w+&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">yuvFd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">vio_err</span><span class="p">(</span><span class="s">&quot;ERRopen(%s) fail&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">vio_err</span><span class="p">(</span><span class="s">&quot;:malloc file&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">fclose</span><span class="p">(</span><span class="n">yuvFd</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">memcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">srcBuf</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">fwrite</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">yuvFd</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">fflush</span><span class="p">(</span><span class="n">yuvFd</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">yuvFd</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">fclose</span><span class="p">(</span><span class="n">yuvFd</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">vio_dbg</span><span class="p">(</span><span class="s">&quot;filedump(%s, size(%d) is successed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">dumpToFile2plane</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">srcBuf</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">srcBuf1</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">yuvFd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">yuvFd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;w+&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">yuvFd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">vio_err</span><span class="p">(</span><span class="s">&quot;open(%s) fail&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size1</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">vio_err</span><span class="p">(</span><span class="s">&quot;ERR:malloc file&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">fclose</span><span class="p">(</span><span class="n">yuvFd</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">memcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">srcBuf</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">memcpy</span><span class="p">(</span><span class="n">buffer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">srcBuf1</span><span class="p">,</span><span class="w"> </span><span class="n">size1</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">fwrite</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size1</span><span class="p">,</span><span class="w"> </span><span class="n">yuvFd</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">fflush</span><span class="p">(</span><span class="n">yuvFd</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">yuvFd</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">fclose</span><span class="p">(</span><span class="n">yuvFd</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">free</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">vio_dbg</span><span class="p">(</span><span class="s">&quot;filedump(%s, size(%d) is successed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-vin-sendpiperaw">
<h3><span class="section-number">5.3.3.32. </span>HB_VIN_SendPipeRaw<a class="headerlink" href="#hb-vin-sendpiperaw" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>int HB_VIN_SendPipeRaw(uint32_t pipeId, void *pstVideoFrame，int32_t millSec)
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>回灌raw接口，数据给ISP处理</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstVideoFrame</td>
<td align="center">回灌raw数据信息</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">millSec</td>
<td align="center">超时参数 millSec<br/>设为-1 时，为阻塞接口；<br/>0 时为 非阻塞接口；<br/>大于 0 时为超时等待时间，<br/>超时时间的 单位为毫秒（ms）</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pipeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">hb_vio_buffer_t</span><span class="w"> </span><span class="o">*</span><span class="n">feedback_buf</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">hb_vio_buffer_t</span><span class="w"> </span><span class="o">*</span><span class="n">isp_yuv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">isp_yuv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">hb_vio_buffer_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">hb_vio_buffer_t</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">isp_yuv</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">hb_vio_buffer_t</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SendPipeRaw</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">feedback_buf</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SendFrame error!!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_GetChnFrame</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">isp_yuv</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_GetPipeFrame error!!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_ReleaseChnFrame</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">isp_yuv</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VPS_ReleaseDevRaw error!!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-vin-setpipeattr-hb-vin-getpipeattr">
<h3><span class="section-number">5.3.3.33. </span>HB_VIN_SetPipeAttr/HB_VIN_GetPipeAttr<a class="headerlink" href="#hb-vin-setpipeattr-hb-vin-getpipeattr" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_SetPipeAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="n">VIN_PIPE_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinPipeAttr</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_GetPipeAttr</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">VIN_PIPE_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">stVinPipeAttr</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置pipe（ISP）属性、获取pipe属性</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">stVinPipeAttr</td>
<td align="center">描述pipe属性的指针</td>
<td align="center">输入，get的时候为输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_CreatePipe/HB_VIN_DestroyPipe举例</p>
</div></blockquote>
</section>
<section id="hb-vin-ctrlpipemirror">
<h3><span class="section-number">5.3.3.34. </span>HB_VIN_CtrlPipeMirror<a class="headerlink" href="#hb-vin-ctrlpipemirror" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_CtrlPipeMirror</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">on</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>pipe镜像控制。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">on</td>
<td align="center">非0打开镜像功能，0关闭镜像功能。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>Flip功能需要借助GDC实现，如先把镜像打开然后再旋转180度。</p>
</div></blockquote>
</section>
<section id="hb-vin-motiondetect">
<h3><span class="section-number">5.3.3.35. </span>HB_VIN_MotionDetect<a class="headerlink" href="#hb-vin-motiondetect" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_MotionDetect</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>检测MD是否有中断,有MD中断就返回</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">检测到运行物体，阻塞调用，未检测到运动物体一直阻塞。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_EnableDevMd举例</p>
</div></blockquote>
</section>
<section id="hb-vin-initlens">
<h3><span class="section-number">5.3.3.36. </span>HB_VIN_InitLens<a class="headerlink" href="#hb-vin-initlens" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_InitLens</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">VIN_LENS_FUNC_TYPE_E</span><span class="w"> </span><span class="n">lensType</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">VIN_LENS_CTRL_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">lenCtlAttr</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>马达驱动初始化。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">lensType</td>
<td align="center">马达的功能类型，AF、Zoom功能</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">lenCtlAttr</td>
<td align="center">控制属性</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>如果使用AF调用一次接口，如果同时使用AF和Zoom功能，调用两次初始化。使用就去调用，不使用建议不调用。</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-vin-deinitlens">
<h3><span class="section-number">5.3.3.37. </span>HB_VIN_DeinitLens<a class="headerlink" href="#hb-vin-deinitlens" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_DeinitLens</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>马达退出</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-vin-registerdiscallback">
<h3><span class="section-number">5.3.3.38. </span>HB_VIN_RegisterDisCallback<a class="headerlink" href="#hb-vin-registerdiscallback" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_RegisterDisCallback</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">VIN_DIS_CALLBACK_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstDISCallback</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>注册dis回调</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstDISCallback</td>
<td align="center">回调接口</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-vin-setdevvcnumber-hb-vin-getdevvcnumber">
<h3><span class="section-number">5.3.3.39. </span>HB_VIN_SetDevVCNumber/HB_VIN_GetDevVCNumber<a class="headerlink" href="#hb-vin-setdevvcnumber-hb-vin-getdevvcnumber" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_SetDevVCNumber</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">vcNumber</span><span class="p">);</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_GetDevVCNumber</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">vcNumber</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置和获取dev的vc_index，使用MIPI的哪个vc.</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">vcNumber</td>
<td align="center">对应mipi的vc,范围0~3</td>
<td align="center">输入，获取的时候为输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
</section>
<section id="hb-vin-adddevvcnumber">
<h3><span class="section-number">5.3.3.40. </span>HB_VIN_AddDevVCNumber<a class="headerlink" href="#hb-vin-adddevvcnumber" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_AddDevVCNumber</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">vcNumber</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置dev的vc_index,使用MIPI的哪个vc.</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输vc入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">vcNumber</td>
<td align="center">对应mipi的vc,范围0~3</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>当使用linear模式时，这个接口不用使用，当使用DOL2模式时，此接口vcNumber设置为1，当使用DOL3模式时，调用两次HB_VIN_AddDevVCNumber，vcNumber分别传0和1.</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>一路DOL2
初始化顺序：</p>
<ol class="simple">
<li><p>把dev0绑到mipi0
HB_VIN_SetMipiBindDev(0, 0)</p></li>
<li><p>把mipi0的虚通道0绑到dev0
HB_VIN_SetDevVCNumber(0, 0)</p></li>
<li><p>把mipi0的虚通道1绑到dev0
HB_VIN_AddDevVCNumber(0, 1);</p></li>
<li><p>把dev0分别绑到ISP pipe0,
HB_VIN_SetDevBindPipe(0, 0)</p></li>
</ol>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_SYS_SetVINVPSMode</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">vin_vps_mode</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_SYS_SetVINVPSMode%d error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">vin_vps_mode</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_CreatePipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">pipeinfo</span><span class="p">);</span><span class="w">   </span><span class="c1">// isp init</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_InitSensor error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetMipiBindDev</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">mipiIdx</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetMipiBindDev error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetDevVCNumber</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">deseri_port</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetDevVCNumber error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_AddDevVCNumber</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">vc_num</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_AddDevVCNumber error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetDevAttr</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">devinfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_MIPI_InitSensor error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetPipeAttr</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">pipeinfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetPipeAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">pipe_err</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetChnDISAttr</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">disinfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetChnDISAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">pipe_err</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetChnLDCAttr</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ldcinfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetChnLDCAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">pipe_err</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetChnAttr</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetChnAttr error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">chn_err</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VIN_SetDevBindPipe</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-vin-setdevmclk">
<h3><span class="section-number">5.3.3.41. </span>HB_VIN_SetDevMclk<a class="headerlink" href="#hb-vin-setdevmclk" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">HB_VIN_SetDevMclk</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devMclk</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">vpuMclk</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置sif mclk和vpu clk.</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">devMclk</td>
<td align="center">Sif mclk设置，请参见SIF MCLK</td>
<td align="center">输入，单位KHz</td>
</tr>
<tr>
<td align="center">vpuMclk</td>
<td align="center">vpu clk设置, 请参见VPU CLK</td>
<td align="center">输入，单位KHz</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-vin-getchnfd">
<h3><span class="section-number">5.3.3.42. </span>HB_VIN_GetChnFd<a class="headerlink" href="#hb-vin-getchnfd" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_GetChnFd</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">chnId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>获取通道的fd</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pipeId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">chnId</td>
<td align="center">通道号，为0</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">正值</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">负值</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-vin-closefd">
<h3><span class="section-number">5.3.3.43. </span>HB_VIN_CloseFd<a class="headerlink" href="#hb-vin-closefd" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_CloseFd</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>关闭通道的fd</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">void</td>
<td align="center">无</td>
<td align="center">无输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>暂无</p>
</div></blockquote>
</section>
<section id="hb-vin-enabledevmd">
<h3><span class="section-number">5.3.3.44. </span>HB_VIN_EnableDevMd<a class="headerlink" href="#hb-vin-enabledevmd" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_EnableDevMd</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>打开motiondetect功能</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>调用得在HB_VIN_SetDevAttrEx之后，HB_VIN_SetDevAttrEx接口是设置MD的一些属性值</p>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">VIN_DEV_ATTR_EX_S</span><span class="w"> </span><span class="n">devAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">path_sel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">roi_top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">roi_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">roi_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1280</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">roi_height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">640</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">grid_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">128</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">grid_tolerance</span><span class="w"> </span><span class="o">=</span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">weight_decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">128</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devAttr</span><span class="p">.</span><span class="w"> </span><span class="n">precision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_SetDevAttrEx</span><span class="p">(</span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="n">devexinfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_SetDevAttrEx error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VIN_EnableDevMd</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_EnableDevMd error!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>下面起一个线程调用HB_VIN_MotionDetect检测收到MD中断后将MD功能关闭HB_VIN_DisableDevMd。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">md_func</span><span class="p">(</span><span class="n">work_info_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">info</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">pipeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="o">-&gt;</span><span class="n">group_id</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">HB_VIN_MotionDetect</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_MotionDetect error!!! ret %d </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">HB_VIN_DisableDevMd</span><span class="p">(</span><span class="n">pipeId</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;HB_VIN_DisableDevMd success!!! ret %d </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-vin-disabledevmd">
<h3><span class="section-number">5.3.3.45. </span>HB_VIN_DisableDevMd<a class="headerlink" href="#hb-vin-disabledevmd" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">HB_VIN_DisableDevMd</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">devId</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>关闭motiondetect功能</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">devId</td>
<td align="center">对应每路输入，范围0~7</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="center">失败</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>用户收到md中断后关闭md功能</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>请参见HB_VIN_EnableDevMd举例</p>
</div></blockquote>
</section>
</section>
<section id="id8">
<h2><span class="section-number">5.3.4. </span>数据结构<a class="headerlink" href="#id8" title="永久链接至标题"></a></h2>
<section id="mipi-input-mode-e">
<h3><span class="section-number">5.3.4.1. </span>MIPI_INPUT_MODE_E<a class="headerlink" href="#mipi-input-mode-e" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_MIPI_INPUT_MODE_E</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">INPUT_MODE_MIPI</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0</span><span class="p">,</span><span class="w">              </span><span class="cm">/* mipi */</span><span class="w"></span>
<span class="w">    </span><span class="n">INPUT_MODE_DVP</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x1</span><span class="p">,</span><span class="w">              </span><span class="cm">/* DVP*/</span><span class="w"></span>
<span class="w">    </span><span class="n">INPUT_MODE_BUTT</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">MIPI_INPUT_MODE_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>sensor接入方式</p>
</div></blockquote>
<p>【成员说明】</p>
<ul class="simple">
<li><p>MIPI接入</p></li>
<li><p>DVP接入</p></li>
</ul>
</section>
<section id="mipi-sensor-mode-e">
<h3><span class="section-number">5.3.4.2. </span>MIPI_SENSOR_MODE_E<a class="headerlink" href="#mipi-sensor-mode-e" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_MIPI_SENSOR_MODE_E</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">NORMAL_M</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">DOL2_M</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="mh">0x1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">DOL3_M</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="mh">0x2</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">PWL_M</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">MIPI_SENSOR_MODE_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>sensor工作模式</p>
</div></blockquote>
<p>【成员说明】</p>
<blockquote>
<div><p>linear模式、DOL2模式、DOL3模式、PWL模式</p>
</div></blockquote>
</section>
<section id="mipi-deserial-info-t">
<h3><span class="section-number">5.3.4.3. </span>MIPI_DESERIAL_INFO_T<a class="headerlink" href="#mipi-deserial-info-t" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_MIPI_DESERIAL_INFO_T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">bus_type</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">bus_num</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">deserial_addr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">physical_entry</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">deserial_name</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">MIPI_DESERIAL_INFO_T</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义serdes初始化的属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">bus_type</td>
<td align="left">总线类型，0是i2c,1是spi</td>
</tr>
<tr>
<td align="center">bus_num</td>
<td align="left">总线号,根据具体板子硬件原理图确定，目前用的5</td>
</tr>
<tr>
<td align="center">deserial_addr</td>
<td align="left">serdes地址</td>
</tr>
<tr>
<td align="center">physical_entry</td>
<td align="left">保留</td>
</tr>
<tr>
<td align="center">deserial_name</td>
<td align="left">serdes名字</td>
</tr>
</tbody>
</table></section>
<section id="mipi-sns-info-s">
<h3><span class="section-number">5.3.4.4. </span>MIPI_SNS_INFO_S<a class="headerlink" href="#mipi-sns-info-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_MIPI_SNS_INFO_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">port</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">dev_port</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">bus_type</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">bus_num</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">fps</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">resolution</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sensor_addr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">serial_addr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">entry_index</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_SENSOR_MODE_E</span><span class="w"> </span><span class="n">sensor_mode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">reg_width</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">sensor_name</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">extra_mode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">deserial_index</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">deserial_port</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">gpio_num</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">gpio_pin</span><span class="p">[</span><span class="n">GPIO_NUM</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">gpio_level</span><span class="p">[</span><span class="n">GPIO_NUM</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_SPI_DATA_S</span><span class="w"> </span><span class="n">spi_info</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">MIPI_SNS_INFO_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义sensor初始化的属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">port</td>
<td align="left">当前sensor的一个逻辑编号，必须从0开始</td>
</tr>
<tr>
<td align="center">dev_port</td>
<td align="left">每路sensor操作的驱动节点，一个驱动支持多个节点。</td>
</tr>
<tr>
<td align="center">bus_type</td>
<td align="left">总线类型，0是i2c,1是spi</td>
</tr>
<tr>
<td align="center">bus_num</td>
<td align="left">总线号，根据具体板子硬件原理图确定,现在默认i2c5</td>
</tr>
<tr>
<td align="center">fps</td>
<td align="left">帧率</td>
</tr>
<tr>
<td align="center">resolution</td>
<td align="left">Sensor的分辨率</td>
</tr>
<tr>
<td align="center">sensor_addr</td>
<td align="left">sensor地址</td>
</tr>
<tr>
<td align="center">serial_addr</td>
<td align="left">sensor内部serdes地址</td>
</tr>
<tr>
<td align="center">entry_index</td>
<td align="left">sensor使用的mipi索引</td>
</tr>
<tr>
<td align="center">sensor_mode</td>
<td align="left">sensor工作模式，1是normal,2是dol2,3是dol3</td>
</tr>
<tr>
<td align="center">reg_width</td>
<td align="left">寄存器地址宽度</td>
</tr>
<tr>
<td align="center">sensor_name</td>
<td align="left">sensor名字</td>
</tr>
<tr>
<td align="center">extra_mode</td>
<td align="left">区分sensor的特性，具体sensor驱动实现</td>
</tr>
<tr>
<td align="center">deserial_index</td>
<td align="left">当前属于哪一个serdes</td>
</tr>
<tr>
<td align="center">deserial_port</td>
<td align="left">当前属于serdes哪一个port</td>
</tr>
<tr>
<td align="center">gpio_num</td>
<td align="left">有的sensor需要gpio上下电，此sensor用到的相关GPIO管脚</td>
</tr>
<tr>
<td align="center">gpio_pin</td>
<td align="left">操作的GPIO管脚，GPIO_NUM是用到的GPIO管脚的个数</td>
</tr>
<tr>
<td align="center">gpio_level</td>
<td align="left">初始有效值，比如该管脚需要先拉低再拉高，此值为0，如果先拉高在拉低，此值为1</td>
</tr>
<tr>
<td align="center">spi_info</td>
<td align="left">sensor spi信息，有的sensor通过spi总线访问</td>
</tr>
</tbody>
</table></section>
<section id="mipi-sensor-info-s">
<h3><span class="section-number">5.3.4.5. </span>MIPI_SENSOR_INFO_S<a class="headerlink" href="#mipi-sensor-info-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_MIPI_SENSOR_INFO_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">    </span><span class="n">deseEnable</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_INPUT_MODE_E</span><span class="w">  </span><span class="n">inputMode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_DESERIAL_INFO_T</span><span class="w"> </span><span class="n">deserialInfo</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_SNS_INFO_S</span><span class="w">  </span><span class="n">sensorInfo</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">MIPI_SENSOR_INFO_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义dev初始化的属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">deseEnable</td>
<td align="left">该sensor是否有serdes</td>
</tr>
<tr>
<td align="center">inputMode</td>
<td align="left">sensor接入方式</td>
</tr>
<tr>
<td align="center">deserialInfo</td>
<td align="left">serdes信息</td>
</tr>
<tr>
<td align="center">sensorInfo</td>
<td align="left">sensor信息</td>
</tr>
</tbody>
</table></section>
<section id="mipi-host-cfg-s">
<h3><span class="section-number">5.3.4.6. </span>MIPI_HOST_CFG_S<a class="headerlink" href="#mipi-host-cfg-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_MIPI_HOST_CFG_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">lane</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">datatype</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">mclk</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">mipiclk</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">fps</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">width</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">height</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">linelenth</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">framelenth</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">settle</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">channel_num</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">  </span><span class="n">channel_sel</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">MIPI_HOST_CFG_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义mipi初始化参数信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">lane</td>
<td align="left">lane个数，0~4</td>
</tr>
<tr>
<td align="center">datatype</td>
<td align="left">数据格式,参见DATA TYPE</td>
</tr>
<tr>
<td align="center">mclk</td>
<td align="left">mipi模块主时钟，目前固定是24MHZ</td>
</tr>
<tr>
<td align="center">mipiclk</td>
<td align="left">sensor 输出 总的mipi bit rate, 单位 Mbits/每秒</td>
</tr>
<tr>
<td align="center">fps</td>
<td align="left">sensor输出实际帧率</td>
</tr>
<tr>
<td align="center">width</td>
<td align="left">sensor输出实际宽度</td>
</tr>
<tr>
<td align="center">height</td>
<td align="left">sensor输出实际高度</td>
</tr>
<tr>
<td align="center">linelenth</td>
<td align="left">sensor输出带blanking的总行长</td>
</tr>
<tr>
<td align="center">framelenth</td>
<td align="left">sensor输出带blanking的总行数</td>
</tr>
<tr>
<td align="center">settle</td>
<td align="left">sensor输出实际 Ttx-zero + Ttx-prepare时间（clk为单位）</td>
</tr>
<tr>
<td align="center">channel_num</td>
<td align="left">使用虚通道的个数</td>
</tr>
<tr>
<td align="center">channel_sel[4]</td>
<td align="left">保存每个虚通道的值</td>
</tr>
</tbody>
</table></section>
<section id="mipi-attr-s">
<h3><span class="section-number">5.3.4.7. </span>MIPI_ATTR_S<a class="headerlink" href="#mipi-attr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_MIPI_ATTR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">MIPI_HOST_CFG_S</span><span class="w"> </span><span class="n">mipi_host_cfg</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">dev_enable</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">MIPI_ATTR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义mipi初始化参数信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">mipi_host_cfg</td>
<td align="left">mipi host属性结构体</td>
</tr>
<tr>
<td align="center">dev_enable</td>
<td align="left">mipi dev是否使能，1是使能，0是关闭</td>
</tr>
</tbody>
</table></section>
<section id="mipi-spi-data-s">
<h3><span class="section-number">5.3.4.8. </span>MIPI_SPI_DATA_S<a class="headerlink" href="#mipi-spi-data-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_MIPI_SPI_DATA_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">spi_mode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">spi_cs</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">spi_speed</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">MIPI_SPI_DATA_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义sensor相关spi信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">spi_mode</td>
<td align="left">spi的工作模式</td>
</tr>
<tr>
<td align="center">spi_cs</td>
<td align="left">spi的片选</td>
</tr>
<tr>
<td align="center">spi_speed</td>
<td align="left">spi的传输速率</td>
</tr>
</tbody>
</table></section>
<section id="vin-dev-size-s">
<h3><span class="section-number">5.3.4.9. </span>VIN_DEV_SIZE_S<a class="headerlink" href="#vin-dev-size-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DEV_SIZE_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">format</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">width</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">height</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">pix_length</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DEV_SIZE_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义dev初始化的属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">format</td>
<td align="left">像素格式，format为0代表是raw8~raw16,根据pixel_lenght来表示究竟是raw8还是raw16。</td>
</tr>
<tr>
<td align="center">width</td>
<td align="left">数据宽</td>
</tr>
<tr>
<td align="center">height</td>
<td align="left">数据高</td>
</tr>
<tr>
<td align="center">pix_length</td>
<td align="left">每个像素点长度</td>
</tr>
</tbody>
</table></section>
<section id="vin-mipi-attr-s">
<h3><span class="section-number">5.3.4.10. </span>VIN_MIPI_ATTR_S<a class="headerlink" href="#vin-mipi-attr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_MIPI_ATTR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">enable</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">ipi_channels</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">ipi_mode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">enable_mux_out</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">enable_frame_id</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">enable_bypass</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">enable_line_shift</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">enable_id_decoder</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">set_init_frame_id</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">set_line_shift_count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">set_bypass_channels</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">enable_pattern</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_MIPI_ATTR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义dev mipi初始化的信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">enable</td>
<td align="left">mipi使能,0是关闭，1是使能</td>
</tr>
<tr>
<td align="center">ipi_channels</td>
<td align="left">ipi_channels表示用了几个channel，默认是0开始，如果设置是2，是用了0，1</td>
</tr>
<tr>
<td align="center">ipi_mode</td>
<td align="left">当DOL2分成两路linear或者DOL3分成一路DOl2和一路linear或者三路linear的时候，此值就赋值为2或3.</td>
</tr>
<tr>
<td align="center">enable_mux_out</td>
<td align="left">使能mux选择输出</td>
</tr>
<tr>
<td align="center">enable_frame_id</td>
<td align="left">是否使能frameid</td>
</tr>
<tr>
<td align="center">enable_bypass</td>
<td align="left">是否使能bypass</td>
</tr>
<tr>
<td align="center">enable_line_shift</td>
<td align="left">未用</td>
</tr>
<tr>
<td align="center">enable_id_decoder</td>
<td align="left">未用</td>
</tr>
<tr>
<td align="center">set_init_frame_id</td>
<td align="left">初始frame id值一般为1</td>
</tr>
<tr>
<td align="center">set_line_shift_count</td>
<td align="left">未用</td>
</tr>
<tr>
<td align="center">set_bypass_channels</td>
<td align="left">未用</td>
</tr>
<tr>
<td align="center">enable_pattern</td>
<td align="left">是否使能testpartern</td>
</tr>
</tbody>
</table></section>
<section id="vin-dev-input-ddr-attr-s">
<h3><span class="section-number">5.3.4.11. </span>VIN_DEV_INPUT_DDR_ATTR_S<a class="headerlink" href="#vin-dev-input-ddr-attr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DEV_INPUT_DDR_ATTR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">stride</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">buf_num</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">raw_feedback_en</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DEV_SIZE_S</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DEV_INPUT_DDR_ATTR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义dev输入信息，offline和回灌场景用</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">stride</td>
<td align="left">硬件stride 跟格式匹配，如果是12bit那么stride = widthx1.5，如果是10bit，stride = widthx1.25,如此类推</td>
</tr>
<tr>
<td align="center">buf_num</td>
<td align="left">回灌的存储数据的 buf 数目</td>
</tr>
<tr>
<td align="center">raw_feedback_en</td>
<td align="left">使能回灌模式，不能和offline 模式同时开启，独立使用</td>
</tr>
<tr>
<td align="center">data</td>
<td align="left">数据格式，见 VIN_DEV_SIZE_S</td>
</tr>
</tbody>
</table></section>
<section id="vin-dev-output-ddr-s">
<h3><span class="section-number">5.3.4.12. </span>VIN_DEV_OUTPUT_DDR_S<a class="headerlink" href="#vin-dev-output-ddr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DEV_OUTPUT_DDR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">stride</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">buffer_num</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">frameDepth</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DEV_OUTPUT_DDR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义dev 输出到ddr初始化的信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">stride</td>
<td align="left">硬件stride 跟格式匹配，目前12bit  1952x1.5</td>
</tr>
<tr>
<td align="center">buffer_num</td>
<td align="left">dev 输出到ddr 的buf 个数</td>
</tr>
<tr>
<td align="center">frameDepth</td>
<td align="left">最多get的帧数, buffer_num是总buff数量，建议frameDepth值最大是ddrOutBufNum – 4。</td>
</tr>
</tbody>
</table></section>
<section id="vin-dev-output-isp-s">
<h3><span class="section-number">5.3.4.13. </span>VIN_DEV_OUTPUT_ISP_S<a class="headerlink" href="#vin-dev-output-isp-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DEV_OUTPUT_ISP_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">dol_exp_num</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">enable_dgain</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">set_dgain_short</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">set_dgain_medium</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">set_dgain_long</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">short_maxexp_lines</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">medium_maxexp_lines</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">vc_short_seq</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">vc_medium_seq</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">vc_long_seq</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DEV_OUTPUT_ISP_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义dev 输出到pipe初始化的信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">dol_exp_num</td>
<td align="left">曝光模式，1 为普通模式，dol 2 或者 3 设置对应数目</td>
</tr>
<tr>
<td align="center">enable_dgain</td>
<td align="left">ISP内部调试参数，暂可忽略</td>
</tr>
<tr>
<td align="center">set_dgain_short</td>
<td align="left">ISP 内部调试参数，暂可忽略</td>
</tr>
<tr>
<td align="center">set_dgain_medium</td>
<td align="left">ISP 内部调试参数，暂可忽略</td>
</tr>
<tr>
<td align="center">set_dgain_long</td>
<td align="left">ISP 内部调试参数，暂可忽略</td>
</tr>
<tr>
<td align="center">short_maxexp_lines</td>
<td align="left">最短帧的最大曝光行数，一般是sensor mode寄存器表中找，DOL2/3需要填，用来分配IRAM大小</td>
</tr>
<tr>
<td align="center">medium_maxexp_lines</td>
<td align="left">普通帧的最大曝光行数，一般是sensor mode寄存器表中找，DOL3需要填，用来分配IRAM大小</td>
</tr>
<tr>
<td align="center">vc_short_seq</td>
<td align="left">用来描述DOL2/3模式下，短帧的顺序</td>
</tr>
<tr>
<td align="center">vc_medium_seq</td>
<td align="left">用来描述DOL2/3模式下，普通帧的顺序</td>
</tr>
<tr>
<td align="center">vc_long_seq</td>
<td align="left">用来描述DOL2/3模式下，长帧的顺序</td>
</tr>
</tbody>
</table></section>
<section id="vin-dev-attr-s">
<h3><span class="section-number">5.3.4.14. </span>VIN_DEV_ATTR_S<a class="headerlink" href="#vin-dev-attr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DEV_ATTR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DEV_SIZE_S</span><span class="w">        </span><span class="n">stSize</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">union</span>
    <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">VIN_MIPI_ATTR_S</span><span class="w">  </span><span class="n">mipiAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">VIN_DVP_ATTR_S</span><span class="w">   </span><span class="n">dvpAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DEV_INPUT_DDR_ATTR_S</span><span class="w"> </span><span class="n">DdrIspAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DEV_OUTPUT_DDR_S</span><span class="w"> </span><span class="n">outDdrAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DEV_OUTPUT_ISP_S</span><span class="w"> </span><span class="n">outIspAttr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="n">VIN_DEV_ATTR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义dev初始化的属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VIN_DEV_SIZE_S</td>
<td align="left">stSize 输入的数据</td>
</tr>
<tr>
<td align="center">VIN_DEV_INTF_MODE_E</td>
<td align="left">enIntfMode sif(dev)输入的接口模式，mipi or dvp,目前都是mipi</td>
</tr>
<tr>
<td align="center">DdrIspAttr</td>
<td align="left">isp(pipe)的输入属性配置，offline或者是回灌</td>
</tr>
<tr>
<td align="center">outDdrAttr</td>
<td align="left">sif(dev)的输出到ddr配置</td>
</tr>
<tr>
<td align="center">outIspAttr</td>
<td align="left">sif到isp一些属性设置</td>
</tr>
</tbody>
</table></section>
<section id="vin-dev-attr-ex-s">
<h3><span class="section-number">5.3.4.15. </span>VIN_DEV_ATTR_EX_S<a class="headerlink" href="#vin-dev-attr-ex-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DEV_ATTR_EX_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">path_sel</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">roi_top</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">roi_left</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">roi_width</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">roi_height</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">grid_step</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">grid_tolerance</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">threshold</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">weight_decay</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">precision</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="n">VIN_DEV_ATTR_EX_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义md相关信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">path_sel</td>
<td align="left">0：sif-isp通路；1：sif-ipu通路</td>
</tr>
<tr>
<td align="center">roi_top</td>
<td align="left">ROI的y坐标</td>
</tr>
<tr>
<td align="center">roi_left</td>
<td align="left">ROI的x坐标</td>
</tr>
<tr>
<td align="center">roi_width</td>
<td align="left">ROI的长，必须是step的整数s倍</td>
</tr>
<tr>
<td align="center">roi_height</td>
<td align="left">ROI的宽， 必须是step的整数倍</td>
</tr>
<tr>
<td align="center">grid_step</td>
<td align="left">对应motion detect的区域中划分的每块的宽和高。为2的整数次幂，有效范围为4~128。</td>
</tr>
<tr>
<td align="center">grid_tolerance</td>
<td align="left">每个块前后两帧进行比较的阈值。当前后两帧中相同块进行相减，插值超过这个阈值时，判断为不同。</td>
</tr>
<tr>
<td align="center">threshold</td>
<td align="left">动态检测选取的ROI区域中划分的块比较不同的个数超过这个阈值,发出mot_det中断。</td>
</tr>
<tr>
<td align="center">weight_decay</td>
<td align="left">新的一帧更新ref buffer时不是完全替代上一帧的数据，而是前后两帧加权平均的结果。Mot_det_wgt_decay为当前帧的权重，前一帧的权重为(256-mot_det_wgt_decay)。</td>
</tr>
<tr>
<td align="center">precision</td>
<td align="left">为进行每个块计算时保留的小数点后的精度的位数，有效范围为1~4.</td>
</tr>
</tbody>
</table></section>
<section id="vin-pipe-sensor-mode-e">
<h3><span class="section-number">5.3.4.16. </span>VIN_PIPE_SENSOR_MODE_E<a class="headerlink" href="#vin-pipe-sensor-mode-e" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_VIN_PIPE_SENSOR_MODE_E</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">SENSOR_NORMAL_MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SENSOR_DOL2_MODE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SENSOR_DOL3_MODE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SENSOR_DOL4_MODE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SENSOR_PWL_MODE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SENSOR_INVAILD_MODE</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_PIPE_SENSOR_MODE_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>sensor工作模式</p>
</div></blockquote>
<p>【成员说明】</p>
<blockquote>
<div><p>normal模式、DOL2模式、DOL3模式、PWL模式（压缩模式）</p>
</div></blockquote>
</section>
<section id="vin-pipe-cfa-pattern-e">
<h3><span class="section-number">5.3.4.17. </span>VIN_PIPE_CFA_PATTERN_E<a class="headerlink" href="#vin-pipe-cfa-pattern-e" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_VIN_PIPE_CFA_PATTERN_E</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">PIPE_BAYER_RGGB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">PIPE_BAYER_GRBG</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">PIPE_BAYER_GBRG</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">PIPE_BAYER_BGGR</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">PIPE_MONOCHROME</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_PIPE_CFA_PATTERN_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>数据格式布局</p>
</div></blockquote>
<p>【成员说明】</p>
<blockquote>
<div><p>不同的数据存储格式</p>
</div></blockquote>
</section>
<section id="vin-pipe-size-s">
<h3><span class="section-number">5.3.4.18. </span>VIN_PIPE_SIZE_S<a class="headerlink" href="#vin-pipe-size-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_PIPE_SIZE_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">format</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">width</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">height</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_PIPE_SIZE_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义pipe size 数据信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">format</td>
<td align="left">数据格式</td>
</tr>
<tr>
<td align="center">width</td>
<td align="left">数据宽</td>
</tr>
<tr>
<td align="center">height</td>
<td align="left">数据高</td>
</tr>
</tbody>
</table></section>
<section id="vin-pipe-calib-s">
<h3><span class="section-number">5.3.4.19. </span>VIN_PIPE_CALIB_S<a class="headerlink" href="#vin-pipe-calib-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_PIPE_CALIB_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">mode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">lname</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_PIPE_CALIB_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>sensor矫正数据加载</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">mode</td>
<td align="left">是否开启sensor矫正数据加载</td>
</tr>
<tr>
<td align="center">lname</td>
<td align="left">对应使用的校准库</td>
</tr>
</tbody>
</table></section>
<section id="vin-pipe-attr-s">
<h3><span class="section-number">5.3.4.20. </span>VIN_PIPE_ATTR_S<a class="headerlink" href="#vin-pipe-attr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_PIPE_ATTR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">ddrOutBufNum</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">  </span><span class="n">frameDepth</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_PIPE_SENSOR_MODE_E</span><span class="w"> </span><span class="n">snsMode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_PIPE_SIZE_S</span><span class="w"> </span><span class="n">stSize</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_PIPE_CFA_PATTERN_E</span><span class="w"> </span><span class="n">cfaPattern</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">   </span><span class="n">temperMode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">   </span><span class="n">ispBypassEn</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">   </span><span class="n">ispAlgoState</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">   </span><span class="n">ispAfEn</span><span class="p">;</span><span class="n">s</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">   </span><span class="n">bitwidth</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">   </span><span class="n">startX</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">   </span><span class="n">startY</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_PIPE_CALIB_S</span><span class="w"> </span><span class="n">calib</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_PIPE_ATTR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义pipe属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">ddrOutBufNum</td>
<td align="left">数据的位宽，8 \10\12\14\16</td>
</tr>
<tr>
<td align="center">frameDepth</td>
<td align="left">最多get的帧数, ddrOutBufNum是总buff数量，建议frameDepth值最大是ddrOutBufNum – 3。</td>
</tr>
<tr>
<td align="center">snsMode</td>
<td align="left">sensor工作模式</td>
</tr>
<tr>
<td align="center">stSize</td>
<td align="left">sensor的数据信息，见17</td>
</tr>
<tr>
<td align="center">cfaPattern</td>
<td align="left">数据格式布局，和sensor保持一致</td>
</tr>
<tr>
<td align="center">temperMode</td>
<td align="left">temper模式，0关闭，2打开</td>
</tr>
<tr>
<td align="center">BypassEnable</td>
<td align="left">是否使能isp的bypass</td>
</tr>
<tr>
<td align="center">ispAlgoState</td>
<td align="left">是否启动3a算法库,1是启动，0是关闭</td>
</tr>
<tr>
<td align="center">bitwidth</td>
<td align="left">位宽，有效值 8、10、12、14、16、20</td>
</tr>
<tr>
<td align="center">startX</td>
<td align="left">相对于原点的X偏移</td>
</tr>
<tr>
<td align="center">startY</td>
<td align="left">相对于原点的Y偏移</td>
</tr>
<tr>
<td align="center">calib</td>
<td align="left">是否开启sensor矫正数据加载，1是开启，0是关闭。</td>
</tr>
</tbody>
</table></section>
<section id="vin-ldc-path-sel-s">
<h3><span class="section-number">5.3.4.21. </span>VIN_LDC_PATH_SEL_S<a class="headerlink" href="#vin-ldc-path-sel-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_LDC_PATH_SEL_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_y_only</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_uv_mode</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_uv_interpo</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">reserved1</span><span class="p">:</span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_h_blank_cyc</span><span class="p">:</span><span class="mi">8</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">reserved0</span><span class="p">:</span><span class="mi">16</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_LDC_PATH_SEL_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义LDC属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">rg_y_only</td>
<td align="left">输出类型</td>
</tr>
<tr>
<td align="center">rg_uv_mode</td>
<td align="left">输出类型</td>
</tr>
<tr>
<td align="center">rg_uv_interpo</td>
<td align="left">turning用</td>
</tr>
<tr>
<td align="center">rg_h_blank_cyc</td>
<td align="left">turning用</td>
</tr>
</tbody>
</table></section>
<section id="vin-ldc-picsize-s">
<h3><span class="section-number">5.3.4.22. </span>VIN_LDC_PICSIZE_S<a class="headerlink" href="#vin-ldc-picsize-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_LDC_PICSIZE_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pic_w</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pic_h</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_LDC_PICSIZE_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义LDC宽高输入信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pic_w</td>
<td align="left">需要设置比接入尺寸  -1 的size, 如果ISP 输出 1920 , 则这里设置 1919</td>
</tr>
<tr>
<td align="center">pic_h</td>
<td align="left">除了size, ldc以及dis 部分其他设置不要更改</td>
</tr>
</tbody>
</table></section>
<section id="vin-ldc-algoparam-s">
<h3><span class="section-number">5.3.4.23. </span>VIN_LDC_ALGOPARAM_S<a class="headerlink" href="#vin-ldc-algoparam-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_LDC_ALGOPARAM_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">rg_algo_param_b</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">rg_algo_param_a</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_LDC_ALGOPARAM_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义LDC属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">rg_algo_param_b</td>
<td align="left">参数需要tuning</td>
</tr>
<tr>
<td align="center">rg_algo_param_a</td>
<td align="left">参数需要tuning</td>
</tr>
</tbody>
</table></section>
<section id="vin-ldc-off-shift-s">
<h3><span class="section-number">5.3.4.24. </span>VIN_LDC_OFF_SHIFT_S<a class="headerlink" href="#vin-ldc-off-shift-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_LDC_OFF_SHIFT_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_center_xoff</span><span class="p">:</span><span class="mi">8</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_center_yoff</span><span class="p">:</span><span class="mi">8</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">reserved0</span><span class="p">:</span><span class="mi">16</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_LDC_OFF_SHIFT_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义LDC属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">rg_center_xoff</td>
<td align="left">处理区域修正</td>
</tr>
<tr>
<td align="center">rg_center_yoff</td>
<td align="left">处理区域修正</td>
</tr>
</tbody>
</table></section>
<section id="vin-ldc-woi-s">
<h3><span class="section-number">5.3.4.25. </span>VIN_LDC_WOI_S<a class="headerlink" href="#vin-ldc-woi-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_LDC_WOI_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_start</span><span class="p">:</span><span class="mi">12</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">reserved1</span><span class="p">:</span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_length</span><span class="p">:</span><span class="mi">12</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">reserved0</span><span class="p">:</span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="n">VIN_LDC_WOI_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义LDC属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">rg_start</td>
<td align="left">处理区域修正</td>
</tr>
<tr>
<td align="center">rg_length</td>
<td align="left">处理区域修正</td>
</tr>
</tbody>
</table></section>
<section id="vin-ldc-attr-s">
<h3><span class="section-number">5.3.4.26. </span>VIN_LDC_ATTR_S<a class="headerlink" href="#vin-ldc-attr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_LDC_ATTR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">         </span><span class="n">ldcEnable</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LDC_PATH_SEL_S</span><span class="w">  </span><span class="n">ldcPath</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">yStartAddr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">cStartAddr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LDC_PICSIZE_S</span><span class="w">  </span><span class="n">picSize</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">lineBuf</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LDC_ALGOPARAM_S</span><span class="w"> </span><span class="n">xParam</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LDC_ALGOPARAM_S</span><span class="w"> </span><span class="n">yParam</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LDC_OFF_SHIFT_S</span><span class="w"> </span><span class="n">offShift</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LDC_WOI_S</span><span class="w">   </span><span class="n">xWoi</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LDC_WOI_S</span><span class="w">   </span><span class="n">yWoi</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_LDC_ATTR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义LDC属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">ldcEnable</td>
<td align="left">LDC是否使能</td>
</tr>
<tr>
<td align="center">ldcPath</td>
<td align="left">输出类型</td>
</tr>
<tr>
<td align="center">yStartAddr</td>
<td align="left">Iram使用地址</td>
</tr>
<tr>
<td align="center">cStartAddr</td>
<td align="left">Iram使用地址</td>
</tr>
<tr>
<td align="center">picSize</td>
<td align="left">接入的尺寸</td>
</tr>
<tr>
<td align="center">lineBuf</td>
<td align="left">值设置99</td>
</tr>
<tr>
<td align="center">xParam</td>
<td align="left">参数需要tuning</td>
</tr>
<tr>
<td align="center">yParam</td>
<td align="left">参数需要tuning</td>
</tr>
<tr>
<td align="center">offShift</td>
<td align="left">处理区域修正</td>
</tr>
<tr>
<td align="center">xWoi</td>
<td align="left">处理区域修正</td>
</tr>
<tr>
<td align="center">yWoi</td>
<td align="left">处理区域修正</td>
</tr>
</tbody>
</table></section>
<section id="vin-dis-picsize-s">
<h3><span class="section-number">5.3.4.27. </span>VIN_DIS_PICSIZE_S<a class="headerlink" href="#vin-dis-picsize-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DIS_PICSIZE_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pic_w</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pic_h</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DIS_PICSIZE_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义DIS属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">pic_w</td>
<td align="left">需要设置比接入尺寸  -1 的size, 如果ISP输出 1920 , 则这里设置 1919</td>
</tr>
<tr>
<td align="center">pic_h</td>
<td align="left">需要设置比接入尺寸  -1 的size</td>
</tr>
</tbody>
</table></section>
<section id="vin-dis-path-sel-s">
<h3><span class="section-number">5.3.4.28. </span>VIN_DIS_PATH_SEL_S<a class="headerlink" href="#vin-dis-path-sel-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DIS_PATH_SEL_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_dis_enable</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">rg_dis_path_sel</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="nl">reserved0</span><span class="p">:</span><span class="mi">30</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DIS_PATH_SEL_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义DIS属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">rg_dis_enable</td>
<td align="left">输出类型</td>
</tr>
<tr>
<td align="center">rg_dis_path_sel</td>
<td align="left">输出类型</td>
</tr>
</tbody>
</table></section>
<section id="vin-dis-crop-s">
<h3><span class="section-number">5.3.4.29. </span>VIN_DIS_CROP_S<a class="headerlink" href="#vin-dis-crop-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DIS_CROP_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">rg_dis_start</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">rg_dis_end</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DIS_CROP_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义DIS属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">rg_dis_start</td>
<td align="left">处理区域修正</td>
</tr>
<tr>
<td align="center">rg_dis_end</td>
<td align="left">处理区域修正</td>
</tr>
</tbody>
</table></section>
<section id="vin-dis-callback-s">
<h3><span class="section-number">5.3.4.30. </span>VIN_DIS_CALLBACK_S<a class="headerlink" href="#vin-dis-callback-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DIS_CALLBACK_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">VIN_DIS_DATA_CB</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pipeId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DIS_MV_INFO_S</span><span class="w"> </span><span class="o">*</span><span class="n">disData</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DIS_CALLBACK_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义dis回调接口</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VIN_DIS_DATA_CB</td>
<td align="left">回调函数，收到数据后返回给用户</td>
</tr>
</tbody>
</table></section>
<section id="vin-dis-mv-info-s">
<h3><span class="section-number">5.3.4.31. </span>VIN_DIS_MV_INFO_S<a class="headerlink" href="#vin-dis-mv-info-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DIS_MV_INFO_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">  </span><span class="n">gmvX</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">  </span><span class="n">gmvY</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">  </span><span class="n">xUpdate</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">  </span><span class="n">yUpdate</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DIS_MV_INFO_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义坐标移动的信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">gmvX</td>
<td align="left">绝对坐标,相对于相机中心的x移动量, 如果相机锁好固定住，gmv就是相对于固定锁好位置的移动。</td>
</tr>
<tr>
<td align="center">gmvY</td>
<td align="left">绝对坐标,相对于相机中心的y移动量</td>
</tr>
<tr>
<td align="center">xUpdate</td>
<td align="left">相对量，相对于前一帧的x移动量, Update则是不管锁在那,只看前一帧相机晃动的位置的移动.(如果前一帧是锁好的位置,则update与gmv相同,但这只会在连续晃动的第一帧发生)</td>
</tr>
<tr>
<td align="center">yUpdate</td>
<td align="left">相对量，相对于前一帧的y移动量</td>
</tr>
</tbody>
</table></section>
<section id="vin-dis-attr-s">
<h3><span class="section-number">5.3.4.32. </span>VIN_DIS_ATTR_S<a class="headerlink" href="#vin-dis-attr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_DIS_ATTR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DIS_PICSIZE_S</span><span class="w"> </span><span class="n">picSize</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DIS_PATH_SEL_S</span><span class="w"> </span><span class="n">disPath</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">disHratio</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">disVratio</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DIS_CROP_S</span><span class="w"> </span><span class="n">xCrop</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_DIS_CROP_S</span><span class="w"> </span><span class="n">yCrop</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_DIS_ATTR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义DIS属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">picSize</td>
<td align="left">输入数据宽高</td>
</tr>
<tr>
<td align="center">disPath</td>
<td align="left">输出类型</td>
</tr>
<tr>
<td align="center">disHratio</td>
<td align="left">设置为65536</td>
</tr>
<tr>
<td align="center">disVrati</td>
<td align="left">设置为65536</td>
</tr>
<tr>
<td align="center">xCrop</td>
<td align="left">处理区域修正</td>
</tr>
<tr>
<td align="center">yCrop</td>
<td align="left">处理区域修正</td>
</tr>
</tbody>
</table></section>
<section id="vin-lens-func-type-e">
<h3><span class="section-number">5.3.4.33. </span>VIN_LENS_FUNC_TYPE_E<a class="headerlink" href="#vin-lens-func-type-e" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_VIN_LENS_FUNC_TYPE_E</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENS_AF_TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENS_ZOOM_TYPE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENS_INVALID</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_LENS_FUNC_TYPE_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>马达功能</p>
</div></blockquote>
<p>【成员说明】</p>
<ul class="simple">
<li><p>AF自动对焦，改变像距</p></li>
<li><p>ZOOM变焦，改变焦距</p></li>
</ul>
</section>
<section id="vin-lens-ctrl-attr-s">
<h3><span class="section-number">5.3.4.34. </span>VIN_LENS_CTRL_ATTR_S<a class="headerlink" href="#vin-lens-ctrl-attr-s" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VIN_LENS_CTRL_ATTR_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">port</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENS_MOTOR_TYPE_E</span><span class="w"> </span><span class="n">motorType</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">maxStep</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">initPos</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">minPos</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">maxPos</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">union</span> <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span> <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pwmNum</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pwmDuty</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pwmPeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">pwmParam</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span> <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pulseForwardNum</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pulseBackNum</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pulseDuty</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">pulsePeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">pulseParam</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span> <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">i2cNum</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">i2cAddr</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">i2cParam</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span> <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">gpioA1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">gpioA2</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">gpioB1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">gpioB2</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">gpioParam</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_LENS_CTRL_ATTR_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>定义pipe属性信息</p>
</div></blockquote>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">port</td>
<td align="left">每一路输入，和pipeId对应</td>
</tr>
<tr>
<td align="center">motorType</td>
<td align="left">电机驱动类型，详见VIN_LENS_MOTOR_TYPE_E</td>
</tr>
<tr>
<td align="center">maxStep</td>
<td align="left">电机最大步数</td>
</tr>
<tr>
<td align="center">initPos</td>
<td align="left">电机初始位置</td>
</tr>
<tr>
<td align="center">minPos</td>
<td align="left">电机最小位置</td>
</tr>
<tr>
<td align="center">maxPos</td>
<td align="left">电机最大位置</td>
</tr>
<tr>
<td align="center">pwmNum</td>
<td align="left">马达控制pwm  设备号</td>
</tr>
<tr>
<td align="center">pwmDuty</td>
<td align="left">马达控制pwm 占空比</td>
</tr>
<tr>
<td align="center">pwmPeriod</td>
<td align="left">马达控制pwm 频率</td>
</tr>
<tr>
<td align="center">pulseForwardNum</td>
<td align="left">马达控制 前向控制 pulse 设备号</td>
</tr>
<tr>
<td align="center">pulseBackNum</td>
<td align="left">马达控制 后向控制 pulse 设备号</td>
</tr>
<tr>
<td align="center">pulseDuty</td>
<td align="left">马达控制 脉冲占空比</td>
</tr>
<tr>
<td align="center">pulsePeriod</td>
<td align="left">马达控制 脉冲 频率</td>
</tr>
<tr>
<td align="center">i2cNum</td>
<td align="left">马达控制I2C 设备号</td>
</tr>
<tr>
<td align="center">i2cAddr</td>
<td align="left">马达控制I2C 地址</td>
</tr>
<tr>
<td align="center">gpioA1</td>
<td align="left">马达控制a+ gpio 号</td>
</tr>
<tr>
<td align="center">gpioA2</td>
<td align="left">马达控制a- gpio 号</td>
</tr>
<tr>
<td align="center">gpioB1</td>
<td align="left">马达控制b+ gpio 号</td>
</tr>
<tr>
<td align="center">gpioB2</td>
<td align="left">马达控制b- gpio 号</td>
</tr>
</tbody>
</table></section>
<section id="vin-lens-motor-type-e">
<h3><span class="section-number">5.3.4.35. </span>VIN_LENS_MOTOR_TYPE_E<a class="headerlink" href="#vin-lens-motor-type-e" title="永久链接至标题"></a></h3>
<p>【结构定义】</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_VIN_LENS_MOTOR_TYPE_E</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENS_PWM_TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENS_PULSE_TYPE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENS_I2C_TYPE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENSSPI_TYPE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIN_LENS_GPIO_TYPE</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIN_LENS_MOTOR_TYPE_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>电机驱动类型，由以上几种。</p>
</div></blockquote>
<p>【成员说明】</p>
<ul class="simple">
<li><p>PWM 驱动、脉冲个数驱动、I2C 通信方式控制、spi 通信方式控制、GPIP 引脚时序控制。
由于硬件环境因素，只调试验证过GPIO方式。</p></li>
</ul>
</section>
<section id="data-type">
<h3><span class="section-number">5.3.4.36. </span>DATA TYPE<a class="headerlink" href="#data-type" title="永久链接至标题"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">Data</th>
<th align="left">Type Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0x28</td>
<td align="left">RAW6</td>
</tr>
<tr>
<td align="center">0x29</td>
<td align="left">RAW7</td>
</tr>
<tr>
<td align="center">0x2A</td>
<td align="left">RAW8</td>
</tr>
<tr>
<td align="center">0x2B</td>
<td align="left">RAW10</td>
</tr>
<tr>
<td align="center">0x2C</td>
<td align="left">RAW12</td>
</tr>
<tr>
<td align="center">0x2D</td>
<td align="left">RAW14</td>
</tr>
<tr>
<td align="center">0x2E</td>
<td align="left">Reserved</td>
</tr>
<tr>
<td align="center">0x18</td>
<td align="left">YUV 420 8-bit</td>
</tr>
<tr>
<td align="center">0x19</td>
<td align="left">YUV 420 10-bit</td>
</tr>
<tr>
<td align="center">0x1A</td>
<td align="left">Legacy YUV420 8-bit</td>
</tr>
<tr>
<td align="center">0x1B</td>
<td align="left">Reserved</td>
</tr>
<tr>
<td align="center">0x1C</td>
<td align="left">YUV 420 8-bit(Chroma Shifted Pixel Sampling)</td>
</tr>
<tr>
<td align="center">0x1D</td>
<td align="left">YUV 420 10-bit(Chroma Shifted Pixel Sampling))</td>
</tr>
<tr>
<td align="center">0x1E</td>
<td align="left">YUV 422 8-bit</td>
</tr>
<tr>
<td align="center">0x1F</td>
<td align="left">YUV 422 10-bit</td>
</tr>
</tbody>
</table></section>
<section id="sif-mclk">
<h3><span class="section-number">5.3.4.37. </span>SIF MCLK<a class="headerlink" href="#sif-mclk" title="永久链接至标题"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">ISP应用场景</th>
<th align="center">SIF_MCLK(MHz)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">8M 30fps输入</td>
<td align="center">326.4</td>
</tr>
<tr>
<td align="left">2M 30fps 2路分时多工</td>
<td align="center">148.36</td>
</tr>
<tr>
<td align="left">2M 30fps 1路输入</td>
<td align="center">102.00</td>
</tr>
<tr>
<td align="left">8M DOL2 30fps</td>
<td align="center">544.00</td>
</tr>
<tr>
<td align="left">2M 15fps 4路分时多工</td>
<td align="center">148.36</td>
</tr>
</tbody>
</table></section>
<section id="vpu-clk">
<h3><span class="section-number">5.3.4.38. </span>VPU CLK<a class="headerlink" href="#vpu-clk" title="永久链接至标题"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">VPU应用场景</th>
<th align="center">编码</th>
<th align="center">VPU_BCLK/VPU_CCLK(MHz)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">8M@30fps</td>
<td align="center">AVC</td>
<td align="center">326.4</td>
</tr>
<tr>
<td align="left"></td>
<td align="center">HEVC</td>
<td align="center">408</td>
</tr>
<tr>
<td align="left">2M*4@30fps</td>
<td align="center">AVC</td>
<td align="center">544</td>
</tr>
<tr>
<td align="left"></td>
<td align="center">HEVC</td>
<td align="center">544</td>
</tr>
<tr>
<td align="left">2M @30fps</td>
<td align="center">AVC</td>
<td align="center">204</td>
</tr>
<tr>
<td align="left"></td>
<td align="center">HEVC</td>
<td align="center">204</td>
</tr>
</tbody>
</table></section>
</section>
<section id="id9">
<h2><span class="section-number">5.3.5. </span>错误码<a class="headerlink" href="#id9" title="永久链接至标题"></a></h2>
<p>VIN错误码如下表：</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">错误码</th>
<th align="left">宏定义</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-268565505</td>
<td align="left">HB_ERR_VIN_CREATE_PIPE_FAIL</td>
<td align="left">创建PIPE失败</td>
</tr>
<tr>
<td align="center">-268565506</td>
<td align="left">HB_ERR_VIN_SIF_INIT_FAIL</td>
<td align="left">DEV(Sif)初始化失败</td>
</tr>
<tr>
<td align="center">-268565507</td>
<td align="left">HB_ERR_VIN_DEV_START_FAIL</td>
<td align="left">DEV(Sif) start失败</td>
</tr>
<tr>
<td align="center">-268565508</td>
<td align="left">HB_ERR_VIN_PIPE_START_FAIL</td>
<td align="left">ISP start失败</td>
</tr>
<tr>
<td align="center">-268565509</td>
<td align="left">HB_ERR_VIN_CHN_UNEXIST</td>
<td align="left">Chn不存在</td>
</tr>
<tr>
<td align="center">-268565510</td>
<td align="left">HB_ERR_VIN_INVALID_PARAM</td>
<td align="left">接口参数错误</td>
</tr>
<tr>
<td align="center">-268565511</td>
<td align="left">HB_ERR_VIN_ISP_INIT_FAIL</td>
<td align="left">ISP初始化错误</td>
</tr>
<tr>
<td align="center">-268565512</td>
<td align="left">HB_ERR_VIN_ISP_FRAME_CORRUPTED</td>
<td align="left">ISP破帧，isp驱动应该会有drop</td>
</tr>
<tr>
<td align="center">-268565513</td>
<td align="left">HB_ERR_VIN_CHANNEL_INIT_FAIL</td>
<td align="left">ISP初始化两个chn通道时失败</td>
</tr>
<tr>
<td align="center">-268565514</td>
<td align="left">HB_ERR_VIN_DWE_INIT_FAIL</td>
<td align="left">DWE初始化失败</td>
</tr>
<tr>
<td align="center">-268565515</td>
<td align="left">HB_ERR_VIN_SET_DEV_ATTREX_FAIL</td>
<td align="left">SIF扩展属性初始化失败</td>
</tr>
<tr>
<td align="center">-268565516</td>
<td align="left">HB_ERR_VIN_LENS_INIT_FAIL</td>
<td align="left">马达初始化失败</td>
</tr>
<tr>
<td align="center">-268565517</td>
<td align="left">HB_ERR_VIN_SEND_PIPERAW_FAIL</td>
<td align="left">SIF回灌raw失败</td>
</tr>
<tr>
<td align="center">-268565518</td>
<td align="left">HB_ERR_VIN_NULL_POINT</td>
<td align="left">VIN模块有空指针</td>
</tr>
<tr>
<td align="center">-268565519</td>
<td align="left">HB_ERR_VIN_GET_CHNFRAME_FAIL</td>
<td align="left">获取ISP出来的数据失败</td>
</tr>
<tr>
<td align="center">-268565520</td>
<td align="left">HB_ERR_VIN_GET_DEVFRAME_FAIL</td>
<td align="left">获取SIF出来的数据失败</td>
</tr>
<tr>
<td align="center">-268565521</td>
<td align="left">HB_ERR_VIN_MD_ENABLE_FAIL</td>
<td align="left">使能MotionDetect失败</td>
</tr>
<tr>
<td align="center">-268565522</td>
<td align="left">HB_ERR_VIN_MD_DISABLE_FAIL</td>
<td align="left">关闭MotionDetect失败</td>
</tr>
<tr>
<td align="center">-268565523</td>
<td align="left">HB_ERR_VIN_SWITCH_SNS_TABLE_FAIL</td>
<td align="left">ISP模式linear\DOL切换失败</td>
</tr>
</tbody>
</table></section>
<section id="id10">
<h2><span class="section-number">5.3.6. </span>参考代码<a class="headerlink" href="#id10" title="永久链接至标题"></a></h2>
<p>VIN部分示例代码可以参考，<a class="reference external" href="../samples/Mpp_Usage_Guidelines/get_sif_data.html">get_sif_data</a>和<a class="reference external" href="../samples/Mpp_Usage_Guidelines/get_isp_data.html">get_isp_data</a>。</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2-System_Control_zh_CN.html" class="btn btn-neutral float-left" title="5.2. 系统控制" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="4-Graphic_System_API_Reference_Manual.html" class="btn btn-neutral float-right" title="5.4. ISP图像系统" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, Horizon Robotics.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>