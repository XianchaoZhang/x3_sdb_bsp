<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.9. 视频解码 &mdash; X3 用户手册 1.0.1 文档</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/horizon_theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/horizon.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/hobot.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="5.10. 图像调试指南" href="10-ISP_Tuning_Guide/index.html" />
    <link rel="prev" title="5.8. 视频编码" href="8-Video_Encode_zh_CN.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> X3 用户手册
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../preface/index.html">1. 前言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/index.html">2. 快速入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/index.html">3. Demo使用指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bsp_develop/index.html">4. BSP开发指南</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">5. 多媒体开发指南</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-Overview_zh_CN.html">5.1. 系统概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-System_Control_zh_CN.html">5.2. 系统控制</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-Video_Input_zh_CN.html">5.3. 视频输入</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-Graphic_System_API_Reference_Manual.html">5.4. ISP图像系统</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-Video_Processing_zh_CN.html">5.5. 视频处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-Region_Processing_zh_CN.html">5.6. 区域处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="7-Video_Output_zh_CN.html">5.7. 视频输出</a></li>
<li class="toctree-l2"><a class="reference internal" href="8-Video_Encode_zh_CN.html">5.8. 视频编码</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.9. 视频解码</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">5.9.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">5.9.2. 功能描述</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">5.9.2.1. 基础规格</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">5.9.2.2. 码流发送方式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">5.9.2.3. 图像输出方式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pts">5.9.2.4. 时间戳(PTS)处理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#buffer">5.9.2.5. 码流Buffer配置模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#skip">5.9.2.6. Skip高级跳帧解码</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">5.9.2.7. 带宽优化模式解码</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">5.9.2.8. 解码器绑定</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">5.9.2.9. 注意事项</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#api">5.9.3. API参考</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-createchn">5.9.3.1. HB_VDEC_CreateChn</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-destroychn">5.9.3.2. HB_VDEC_DestroyChn</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-startrecvstream">5.9.3.3. HB_VDEC_StartRecvStream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-stoprecvstream">5.9.3.4. HB_VDEC_StopRecvStream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-resetchn">5.9.3.5. HB_VDEC_ResetChn</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-sendstream">5.9.3.6. HB_VDEC_SendStream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-getframe">5.9.3.7. HB_VDEC_GetFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-releaseframe">5.9.3.8. HB_VDEC_ReleaseFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-getfd">5.9.3.9. HB_VDEC_GetFd</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-closefd">5.9.3.10. HB_VDEC_CloseFd</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-getchnattr">5.9.3.11. HB_VDEC_GetChnAttr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-setchnattr">5.9.3.12. HB_VDEC_SetChnAttr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-querystatus">5.9.3.13. HB_VDEC_QueryStatus</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-getuserdata">5.9.3.14. HB_VDEC_GetUserData</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-releaseuserdata">5.9.3.15. HB_VDEC_ReleaseUserData</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">5.9.4. 数据结构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#video-mode-e">5.9.4.1. VIDEO_MODE_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#video-output-order-e">5.9.4.2. VIDEO_OUTPUT_ORDER_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#video-dec-mode-e">5.9.4.3. VIDEO_DEC_MODE_E</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vdec-attr-h264-s">5.9.4.4. VDEC_ATTR_H264_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vdec-attr-h265-s">5.9.4.5. VDEC_ATTR_H265_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vdec-attr-mjpeg-s">5.9.4.6. VDEC_ATTR_MJPEG_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vdec-attr-jpeg-s">5.9.4.7. VDEC_ATTR_JPEG_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vdec-chn-attr-s">5.9.4.8. VDEC_CHN_ATTR_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-userdata-s">5.9.4.9. HB_VDEC_USERDATA_S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hb-vdec-chn-status-s">5.9.4.10. HB_VDEC_CHN_STATUS_S</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id11">5.9.5. 错误码</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">5.9.6. 参考代码</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="10-ISP_Tuning_Guide/index.html">5.10. 图像调试指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="11-Image_Media_Module_Debugging_Guide/MU-2520-11-X3J3_Image_Media_Module_Debugging_Guide_zh_CN.html">5.11. 查询多媒体模块调试信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="12-Media_Processing_Performance_Debug_Guide.html">5.12. 多媒体性能调试</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ai_toolchain_develop/index.html">6. 量化工具链开发指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pc_tools/index.html">7. PC工具使用指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQs/index.html">8. FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feedback.html">9. 建议反馈</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">X3 用户手册</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">5. </span>多媒体开发指南</a> &raquo;</li>
      <li><span class="section-number">5.9. </span>视频解码</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="8-Video_Encode_zh_CN.html" class="btn btn-neutral float-left" title="5.8. 视频编码" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="10-ISP_Tuning_Guide/index.html" class="btn btn-neutral float-right" title="5.10. 图像调试指南" accesskey="n">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1><span class="section-number">5.9. </span>视频解码<a class="headerlink" href="#id1" title="永久链接至标题"></a></h1>
<section id="id2">
<h2><span class="section-number">5.9.1. </span>概述<a class="headerlink" href="#id2" title="永久链接至标题"></a></h2>
<p>视频解码模块支持H.264/H.265/JPEG/MJPEG硬件解码。该模块支持多通道实时编码，各通道相互独立，常见的使用场景，包括智能盒子、课堂录播等。</p>
</section>
<section id="id3">
<h2><span class="section-number">5.9.2. </span>功能描述<a class="headerlink" href="#id3" title="永久链接至标题"></a></h2>
<section id="id4">
<h3><span class="section-number">5.9.2.1. </span>基础规格<a class="headerlink" href="#id4" title="永久链接至标题"></a></h3>
<p>X3支持的解码规格如下：</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">硬件解码模块</th>
<th align="left">最大通道数</th>
<th align="left">支持协议</th>
<th align="left">分辨率支持</th>
<th align="left">最大性能</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">VPU<br/>JPU</td>
<td align="left">32</td>
<td align="left"><strong>VPU:</strong><br/>H.264/H.265<br/><strong>JPU:</strong><br/>JPEG/MJPEG</td>
<td align="left"><strong>VPU:</strong><br/>- H264:<br />max 8192×8192<br/>min：32×32<br/>- H265:<br />max 8192×8192<br/>Min: 8×8<br/><strong>JPU:</strong><br/>- JPEG/MJPEG:<br />max 32768×32768<br />min:16×16</td>
<td align="left"><strong>H264/H265:</strong><br/>3840×2160 @60fps<br/><strong>JPEG/MJPEG:</strong> <br/>YUV4:2:0 290M pixel/sec<br/></td>
</tr>
</tbody>
</table></section>
<section id="id5">
<h3><span class="section-number">5.9.2.2. </span>码流发送方式<a class="headerlink" href="#id5" title="永久链接至标题"></a></h3>
<p>X3视频解码器支持按帧发送(VIDEO_MODE_FRAME)码流方式：</p>
<p>用户每次发送完整一帧码流到解码器。解码器就认为该帧码流已经结束，开始解码图像，因此需保证每次调用发送接口发送的码流必须为一帧，否则会出现解码错误。</p>
<p>码流发送方式enMode在VDEC_CHN_ATTR_S解码通道属性结构体中定义，用户可以通过调用HB_VDEC_SetChnAttr()配置解码通道属性函数来完成。</p>
</section>
<section id="id6">
<h3><span class="section-number">5.9.2.3. </span>图像输出方式<a class="headerlink" href="#id6" title="永久链接至标题"></a></h3>
<p>根据H.264/H.265协议，解码图像可能不会在解码后立即输出。X3视频解码器可以通过设置不同的图像输出方式达到尽快输出的目的。图像输出方式包括以下两种：</p>
<ul class="simple">
<li><p>解码序：解码图像按照解码的先后顺序输出。</p></li>
<li><p>显示序：解码图像按照H.264/H.265协议输出。</p></li>
</ul>
<p>根据H.264/H.265协议，视频的解码顺序未必是视频的输出顺序(即显示序)。例如B帧解码时需要前后的P帧作为参数，所以B帧后的P帧先于B帧解码，但B帧先于P帧输出。按解码序输出是保证快速输出的一个必要条件，用户选择按解码序输出，需保证码流的解码序和显示序相同。</p>
<ul class="simple">
<li><p>按帧发送码流与按解码序输出相结合能达到快速解码和快速输出的目的，用户必须保证每次发送的是完整的一帧码流以及码流的解码序和显示序相同。</p></li>
<li><p>按帧发送码流与按显示序输出想结合，注意需要在最后一帧设置码流结束时必配置帧结束标志stream_end为HB_TRUE，否则认为当前帧码流还未结束，会出现解码异常。</p></li>
</ul>
<p>图像输出方式enOutPutOrder在VDEC_CHN_ATTR_S解码通道属性结构体中定义，用户可以通过调用HB_VDEC_SetChnAttr()配置解码通道属性函数来完成。</p>
</section>
<section id="pts">
<h3><span class="section-number">5.9.2.4. </span>时间戳(PTS)处理<a class="headerlink" href="#pts" title="永久链接至标题"></a></h3>
<p>VDEC模块在选择帧发送(VIDEO_MODE_FRAME)模型下发送码流时，解码输出的图像时间戳PTS为发送码流接口(HB_VDEC_SendStream)中用户送入的PTS，解码器不会更改此值。</p>
</section>
<section id="buffer">
<h3><span class="section-number">5.9.2.5. </span>码流Buffer配置模式<a class="headerlink" href="#buffer" title="永久链接至标题"></a></h3>
<p>解码码流buffer配置支持外部模式和内部模式。</p>
<ul>
<li><p>外部模式：用户通过调用HB_VP_Init()函数进行对Video Pool池初始化，然后可以选择公共pool或者通过HB_SYS_Alloc()函数创建私有的pool池的mmz内存，用于存放需要解码的码流。用户创建的ion内存的buffer数量建议和解码通道中设置的流buffer数量u32StreamBufCnt一致，每一次解码需要把分配的ion内存的虚拟地址首地址赋值给VIDEO_STREAM_S结构体中的vir_ptr字段，需要解码的流大小赋值给VIDEO_STREAM_S结构体中的size字段。解码器内部实际是通过buffer轮转的方式去解码的，即依次取buffer号中的流数。如果图像输出方式设置为显示序，需要把一个GOP内部的所有帧都读取完才开始解码。</p>
<p>通过设置解码器通道属性VDEC_CHN_ATTR_S结构体中的bExternalBitStreamBuff字段为HB_TRUE来使用外部buffer模式。</p>
</li>
<li><p>内部模式：用户通过其他工具，例如FFMPEG来进行对码流的切分(一般以帧模式来读取)，此时用户不需要申请VB缓存，只需要把码流切分之后的buffer地址传递给VIDEO_STREAM_S结构体中的vir_ptr字段，内部会自动做拷贝到编码器申请的流buffer地址空间中，节约了VB的使用。</p>
<p>通过设置解码器通道属性VDEC_CHN_ATTR_S结构体中的bExternalBitStreamBuff字段为HB_FALSE来使用外部buffer模式</p>
</li>
</ul>
</section>
<section id="skip">
<h3><span class="section-number">5.9.2.6. </span>Skip高级跳帧解码<a class="headerlink" href="#skip" title="永久链接至标题"></a></h3>
<p>用户可以通过设置解码器通道属性VDEC_CHN_ATTR_S结构体中的enDecMode来控制解码时是否使用跳帧(默认不开启，即所有帧都解码)。可以选择只解码IRAP帧或者只解码参数参数帧，具体可以参考帧skip设置。</p>
</section>
<section id="id7">
<h3><span class="section-number">5.9.2.7. </span>带宽优化模式解码<a class="headerlink" href="#id7" title="永久链接至标题"></a></h3>
<p>用户可以通过设置解码器通道属性VDEC_CHN_ATTR_S结构体中的bandwidth_Opt来控制解码时是否使用带宽优化(默认是开启)。
该模式支持VPU忽略将压缩格式的非参考帧或者线性格式的非显示帧写入frame buffer中，以此来节省带宽。</p>
</section>
<section id="id8">
<h3><span class="section-number">5.9.2.8. </span>解码器绑定<a class="headerlink" href="#id8" title="永久链接至标题"></a></h3>
<p>解码器绑定后，不可再调用HB_VDEC_GetFrame。</p>
</section>
<section id="id9">
<h3><span class="section-number">5.9.2.9. </span>注意事项<a class="headerlink" href="#id9" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p>H.264/H.265解码得时候第一个帧，要给齐sps，pps，idr，如果只给sps就会报错,报错信息是 FAILED TO DEC_PIC_HDR: ret(1), SEQERR(00005000)</p></li>
</ul>
</section>
</section>
<section id="api">
<h2><span class="section-number">5.9.3. </span>API参考<a class="headerlink" href="#api" title="永久链接至标题"></a></h2>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span>HB_VDEC_CreateChn：创建视频解码通道。
HB_VDEC_DestroyChn：销毁视频解码通道。
HB_VDEC_StartRecvStream：解码器开始接收用户发送的码流。
HB_VDEC_StopRecvStream：解码器停止接收用户发送的码流。
HB_VDEC_ResetChn：复位解码通道。
HB_VDEC_SendStream：向视频解码通道发送码流数据。
HB_VDEC_GetFrame：获取视频解码通道的解码图像。
HB_VDEC_ReleaseFrame：释放视频解码通道的解码图像。
HB_VDEC_GetFd：获取视频解码通道的设备文件句柄。
HB_VDEC_CloseFd：关闭视频解码通道的设备文件句柄。
HB_VDEC_SetChnAttr：设置解码通道参数。
HB_VDEC_GetChnAttr：获取解码通道参数。
HB_VDEC_QueryStatus：查询解码状态。
HB_VDEC_GetUserData：获取用户数据。
HB_VDEC_ReleaseUserData：释放用户数据。
</pre></div>
</div>
<section id="hb-vdec-createchn">
<h3><span class="section-number">5.9.3.1. </span>HB_VDEC_CreateChn<a class="headerlink" href="#hb-vdec-createchn" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="n">HB_VDEC_CreateChn</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">VDEC_CHN_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstAttr</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>创建视频解码通道。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstAttr</td>
<td align="center">解码通道属性指针。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>HB_VDEC_ResetChn参考代码</p>
</div></blockquote>
</section>
<section id="hb-vdec-destroychn">
<h3><span class="section-number">5.9.3.2. </span>HB_VDEC_DestroyChn<a class="headerlink" href="#hb-vdec-destroychn" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_DestroyChn</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>销毁视频解码通道。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>HB_VDEC_ResetChn参考代码</p>
</div></blockquote>
</section>
<section id="hb-vdec-startrecvstream">
<h3><span class="section-number">5.9.3.3. </span>HB_VDEC_StartRecvStream<a class="headerlink" href="#hb-vdec-startrecvstream" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_StartRecvStream</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>解码器开始接收用户发送的码流.。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>HB_VDEC_ResetChn参考代码</p>
</div></blockquote>
</section>
<section id="hb-vdec-stoprecvstream">
<h3><span class="section-number">5.9.3.4. </span>HB_VDEC_StopRecvStream<a class="headerlink" href="#hb-vdec-stoprecvstream" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_StopRecvStream</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>解码器停止接收用户发送的码流。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>HB_VDEC_ResetChn参考代码</p>
</div></blockquote>
</section>
<section id="hb-vdec-resetchn">
<h3><span class="section-number">5.9.3.5. </span>HB_VDEC_ResetChn<a class="headerlink" href="#hb-vdec-resetchn" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_ResetChn</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>复位视频解码通道。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VDEC_Chn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">s32Ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">Width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1920</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">Height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1080</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VDEC_CHN_ATTR_S</span><span class="w"> </span><span class="n">m_VdecChnAttr</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">VDEC_CHN_ATTR_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PT_H264</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_MODE_FRAME</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enPixelFormat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_PIXEL_FORMAT_NV12</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32FrameBufCnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32StreamBufCnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32StreamBufSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Height</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">bExternalBitStreamBuf</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PT_H265</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">bandwidth_Opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">enDecMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_DEC_MODE_NORMAL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">enOutputOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_OUTPUT_ORDER_DISP</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">cra_as_bla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_FALSE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">dec_temporal_id_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">target_dec_temporal_id_plus1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PT_H264</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">bandwidth_Opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">enDecMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_DEC_MODE_NORMAL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">enOutputOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_OUTPUT_ORDER_DISP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">s32Ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VDEC_CreateChn</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_SetChnAttr</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_StartRecvStream</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_StopRecvStream</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_ResetChn</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_DestroyChn</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-vdec-sendstream">
<h3><span class="section-number">5.9.3.6. </span>HB_VDEC_SendStream<a class="headerlink" href="#hb-vdec-sendstream" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_SendStream</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">VIDEO_STREAM_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstStream</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">s32MilliSec</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>向视频解码通道发送码流数据</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstStream</td>
<td align="center">解码码流数据指针。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">s32MilliSec</td>
<td align="center">送码流超时时间。<br/>取值范围：[-1, + ∞ )<br/> -1：阻塞。<br/> 0：非阻塞。<br/> 大于 0：超时时间。</td>
<td align="center"></td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<p>【参考代码】</p>
</section>
<section id="hb-vdec-getframe">
<h3><span class="section-number">5.9.3.7. </span>HB_VDEC_GetFrame<a class="headerlink" href="#hb-vdec-getframe" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_GetFrame</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="n">VIDEO_FRAME_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstFrameInfo</span><span class="p">,</span><span class="kt">int32_t</span><span class="w"> </span><span class="n">s32MilliSec</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>获取视频解码通道的解码图像。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstFrameInfo</td>
<td align="center">获取的解码图像信息。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">s32MilliSec</td>
<td align="center">获取图像超时时间。<br/>取值范围：[-1, + ∞ )<br/> -1：阻塞。<br/> 0：非阻塞。<br/> 大于 0：超时时间。</td>
<td align="center"></td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<p>【参考代码】</p>
</section>
<section id="hb-vdec-releaseframe">
<h3><span class="section-number">5.9.3.8. </span>HB_VDEC_ReleaseFrame<a class="headerlink" href="#hb-vdec-releaseframe" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_ReleaseFrame</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">VIDEO_FRAME_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstFrameInfo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>释放视频解码通道的图像。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstFrameInfo    解码后的图像信息指针。 输入</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<p>【参考代码】</p>
</section>
<section id="hb-vdec-getfd">
<h3><span class="section-number">5.9.3.9. </span>HB_VDEC_GetFd<a class="headerlink" href="#hb-vdec-getfd" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_GetFd</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="o">*</span><span class="n">fd</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>获取解码通道对应的设备文件句柄。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">fd</td>
<td align="center">返回编码通道文件句柄。</td>
<td align="center">输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VDEC_Chn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">s32Ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">Width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1920</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">Height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1080</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VDEC_CHN_ATTR_S</span><span class="w"> </span><span class="n">m_VdecChnAttr</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">VDEC_CHN_ATTR_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PT_H264</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_MODE_FRAME</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enPixelFormat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_PIXEL_FORMAT_NV12</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32FrameBufCnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32StreamBufCnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32StreamBufSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Height</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">bExternalBitStreamBuf</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PT_H265</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">bandwidth_Opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">enDecMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_DEC_MODE_NORMAL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">enOutputOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_OUTPUT_ORDER_DISP</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">cra_as_bla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_FALSE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">dec_temporal_id_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">target_dec_temporal_id_plus1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PT_H264</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">bandwidth_Opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">enDecMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_DEC_MODE_NORMAL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">enOutputOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_OUTPUT_ORDER_DISP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">s32Ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VDEC_CreateChn</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_SetChnAttr</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_GetFd</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">fd</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_CloseFd</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="n">fd</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">s32Ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VDEC_DestroyChn</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-vdec-closefd">
<h3><span class="section-number">5.9.3.10. </span>HB_VDEC_CloseFd<a class="headerlink" href="#hb-vdec-closefd" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_CloseFd</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">fd</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>关闭解码通道对应的设备文件句柄。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">fd</td>
<td align="center">设置编码通道文件句柄。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>HB_VDEC_GetFd参考代码</p>
</div></blockquote>
</section>
<section id="hb-vdec-getchnattr">
<h3><span class="section-number">5.9.3.11. </span>HB_VDEC_GetChnAttr<a class="headerlink" href="#hb-vdec-getchnattr" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_GetChnAttr</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="n">VDEC_CHN_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstAttr</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>获取视频解码通道参数。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstAttr</td>
<td align="center">解码后的通道属性指针。</td>
<td align="center">输出</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VDEC_Chn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">s32Ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">Width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1920</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">Height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1080</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">VDEC_CHN_ATTR_S</span><span class="w"> </span><span class="n">m_VdecChnAttr</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">VDEC_CHN_ATTR_S</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PT_H264</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_MODE_FRAME</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enPixelFormat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_PIXEL_FORMAT_NV12</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32FrameBufCnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32StreamBufCnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">u32StreamBufSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Height</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">bExternalBitStreamBuf</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PT_H265</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">bandwidth_Opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">enDecMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_DEC_MODE_NORMAL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">enOutputOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_OUTPUT_ORDER_DISP</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">cra_as_bla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_FALSE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">dec_temporal_id_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH265</span><span class="p">.</span><span class="n">target_dec_temporal_id_plus1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">enType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PT_H264</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">bandwidth_Opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_TRUE</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">enDecMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_DEC_MODE_NORMAL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_VdecChnAttr</span><span class="p">.</span><span class="n">stAttrH264</span><span class="p">.</span><span class="n">enOutputOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VIDEO_OUTPUT_ORDER_DISP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">s32Ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VDEC_CreateChn</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_SetChnAttr</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m_VdecChnAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_VDEC_GetChnAttr</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">VdecChnAttr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">s32Ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HB_VDEC_DestroyChn</span><span class="p">(</span><span class="n">VDEC_Chn</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="hb-vdec-setchnattr">
<h3><span class="section-number">5.9.3.12. </span>HB_VDEC_SetChnAttr<a class="headerlink" href="#hb-vdec-setchnattr" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_SetChnAttr</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">VDEC_CHN_ATTR_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstAttr</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>设置视频解码通道参数。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstAttr</td>
<td align="center">解码后的通道属性指针。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>HB_VDEC_GetChnAttr参考代码</p>
</div></blockquote>
</section>
<section id="hb-vdec-querystatus">
<h3><span class="section-number">5.9.3.13. </span>HB_VDEC_QueryStatus<a class="headerlink" href="#hb-vdec-querystatus" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_QueryStatus</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="n">VDEC_CHN_STATUS_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstStatus</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>查询解码通道状态。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">解码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstStatus</td>
<td align="center">解码通道的状态指针。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
</section>
<section id="hb-vdec-getuserdata">
<h3><span class="section-number">5.9.3.14. </span>HB_VDEC_GetUserData<a class="headerlink" href="#hb-vdec-getuserdata" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_GetUserData</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="n">VDEC_USERDATA_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstUserData</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">s32MilliSec</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>获取视频解码通道用户数据。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstUserData</td>
<td align="center">用户数据指针。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">s32MilliSec</td>
<td align="center">超时时间。</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
</section>
<section id="hb-vdec-releaseuserdata">
<h3><span class="section-number">5.9.3.15. </span>HB_VDEC_ReleaseUserData<a class="headerlink" href="#hb-vdec-releaseuserdata" title="永久链接至标题"></a></h3>
<p>【函数声明】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span><span class="w"> </span><span class="nf">HB_VDEC_ReleaseUserData</span><span class="p">(</span><span class="n">VDEC_CHN</span><span class="w"> </span><span class="n">VdChn</span><span class="p">,</span><span class="w"> </span><span class="n">VDEC_USERDATA_S</span><span class="w"> </span><span class="o">*</span><span class="n">pstUserData</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>【功能描述】</p>
<blockquote>
<div><p>释放解码通道用户数据。</p>
</div></blockquote>
<p>【参数描述】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">参数名称</th>
<th align="center">描述</th>
<th align="center">输入/输出</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VdChn</td>
<td align="center">编码通道号。<br/>取值范围：[0, VDEC_MAX_CHN_NUM)。</td>
<td align="center">输入</td>
</tr>
<tr>
<td align="center">pstUserData</td>
<td align="center">用户数据指针</td>
<td align="center">输入</td>
</tr>
</tbody>
</table><p>【返回值】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">返回值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="center">非0</td>
<td align="left">失败，返回错误码。</td>
</tr>
</tbody>
</table><p>【注意事项】</p>
<blockquote>
<div><p>无</p>
</div></blockquote>
<p>【参考代码】</p>
<blockquote>
<div><p>HB_VDEC_GetFd参考代码</p>
</div></blockquote>
</section>
</section>
<section id="id10">
<h2><span class="section-number">5.9.4. </span>数据结构<a class="headerlink" href="#id10" title="永久链接至标题"></a></h2>
<section id="video-mode-e">
<h3><span class="section-number">5.9.4.1. </span>VIDEO_MODE_E<a class="headerlink" href="#video-mode-e" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义码流发送方式。</p>
</div></blockquote>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_VIDEO_MODE_E</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_MODE_FRAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_MODE_BUTT</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIDEO_MODE_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VIDEO_MODE_FRAME</td>
<td align="center">按帧方式发送码流。<br/>以帧为单位。</td>
</tr>
</tbody>
</table></section>
<section id="video-output-order-e">
<h3><span class="section-number">5.9.4.2. </span>VIDEO_OUTPUT_ORDER_E<a class="headerlink" href="#video-output-order-e" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义视频解码输出顺序枚举。</p>
</div></blockquote>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_VIDEO_OUTPUT_ORDER_E</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_OUTPUT_ORDER_DISP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_OUTPUT_ORDER_DEC</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_OUTPUT_ORDER_BUTT</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIDEO_OUTPUT_ORDER_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VIDEO_OUTPUT_ORDER_DISP</td>
<td align="center">显示序输出。</td>
</tr>
<tr>
<td align="center">VIDEO_OUTPUT_ORDER_DEC</td>
<td align="center">解码序输出。</td>
</tr>
</tbody>
</table></section>
<section id="video-dec-mode-e">
<h3><span class="section-number">5.9.4.3. </span>VIDEO_DEC_MODE_E<a class="headerlink" href="#video-dec-mode-e" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义视频解码模式枚举。</p>
</div></blockquote>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">HB_VIDEO_DEC_MODE_E</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_DEC_MODE_NORMAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_DEC_MODE_IRAP</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_DEC_MODE_REF</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_DEC_MODE_THUMB</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_DEC_MODE_BUTT</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VIDEO_DEC_MODE_E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VIDEO_DEC_MODE_NORMAL</td>
<td align="center">Decode IPB frame</td>
</tr>
<tr>
<td align="center">VIDEO_DEC_MODE_IRAP</td>
<td align="center">Decode IRAP frame</td>
</tr>
<tr>
<td align="center">VIDEO_DEC_MODE_REF</td>
<td align="center">Decode reference frame</td>
</tr>
<tr>
<td align="center">VIDEO_DEC_MODE_THUMB</td>
<td align="center">Decode IRAP fream without DPB</td>
</tr>
</tbody>
</table></section>
<section id="vdec-attr-h264-s">
<h3><span class="section-number">5.9.4.4. </span>VDEC_ATTR_H264_S<a class="headerlink" href="#vdec-attr-h264-s" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义H264解码参数。</p>
</div></blockquote>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VDEC_ATTR_H264_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_DEC_MODE_E</span><span class="w"> </span><span class="n">enDecMode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_OUTPUT_ORDER_E</span><span class="w"> </span><span class="n">enOutputOrder</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_BOOL</span><span class="w"> </span><span class="n">bandwidth_Opt</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VDEC_ATTR_H264_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">enDecMode</td>
<td align="center">解码模式，正常解码还是skip跳帧模式解码。</td>
</tr>
<tr>
<td align="center">enOutputOrder</td>
<td align="center">解码图像输出顺序，是解码序输出还是显示序输出。</td>
</tr>
<tr>
<td align="center">bandwidth_Opt</td>
<td align="center">使能节省带宽模式，该模式支持VPU忽略将压缩格式的非参考帧或者线性格式的非显示帧写入frame buffer中，以此来节省带宽。</td>
</tr>
</tbody>
</table></section>
<section id="vdec-attr-h265-s">
<h3><span class="section-number">5.9.4.5. </span>VDEC_ATTR_H265_S<a class="headerlink" href="#vdec-attr-h265-s" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义H265解码参数。</p>
</div></blockquote>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VDEC_ATTR_H265_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_DEC_MODE_E</span><span class="w"> </span><span class="n">enDecMode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_OUTPUT_ORDER_E</span><span class="w"> </span><span class="n">enOutputOrder</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_BOOLcra_as_bla</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_BOOL</span><span class="w"> </span><span class="n">bandwidth_Opt</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">dec_temporal_id_mode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">target_dec_temporal_id_plus1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VDEC_ATTR_H265_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">enDecMode</td>
<td align="center">解码模式，正常解码还是skip跳帧模式解码。</td>
</tr>
<tr>
<td align="center">enOutputOrder</td>
<td align="center">解码图像输出顺序，是解码序输出还是显示序输出。</td>
</tr>
<tr>
<td align="center">cra_as_bla</td>
<td align="center">使能CRA作为BLA处理</td>
</tr>
<tr>
<td align="center">bandwidth_Opt</td>
<td align="center">使能节省带宽模式，该模式支持VPU忽略将压缩格式的非参考帧或者线性格式的非显示帧写入frame buffer中，以此来节省带宽。</td>
</tr>
<tr>
<td align="center">dec_temporal_id_mode</td>
<td align="center">指定temporal id的选择模式。0是使用绝对值模式，1是使用相对值模式</td>
</tr>
<tr>
<td align="center">target_dec_temporal_id_plus1</td>
<td align="center">该值等于0x0，tempral ID在任何范围内，都会解码图像<br/>该值在【0x1~0x6】范围内，如果tempral ID小于等于TARGET_DEC_TEMP_ID才会解码一张图像</td>
</tr>
</tbody>
</table></section>
<section id="vdec-attr-mjpeg-s">
<h3><span class="section-number">5.9.4.6. </span>VDEC_ATTR_MJPEG_S<a class="headerlink" href="#vdec-attr-mjpeg-s" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span>定义MJPEG解码参数。
</pre></div>
</div>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VDEC_ATTR_MJPEG_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">CODEC_ROTATION_E</span><span class="w"> </span><span class="n">enRotation</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIRROR_FLIP_E</span><span class="w"> </span><span class="n">enMirrorFlip</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_CROP_INFO_S</span><span class="w"> </span><span class="n">stCropCfg</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VDEC_ATTR_MJPEG_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">enRotation</td>
<td align="center">指定旋转角度，包括0，90，180，270</td>
</tr>
<tr>
<td align="center">enMirrorFlip;</td>
<td align="center">指定镜像模式</td>
</tr>
<tr>
<td align="center">stCropCfg</td>
<td align="center">指定解码区域</td>
</tr>
</tbody>
</table></section>
<section id="vdec-attr-jpeg-s">
<h3><span class="section-number">5.9.4.7. </span>VDEC_ATTR_JPEG_S<a class="headerlink" href="#vdec-attr-jpeg-s" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义JPEG解码参数。
【结构定义】</p>
</div></blockquote>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VDEC_ATTR_JPEG_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">CODEC_ROTATION_E</span><span class="w"> </span><span class="n">enRotation</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">MIRROR_FLIP_E</span><span class="w"> </span><span class="n">enMirrorFlip</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">VIDEO_CROP_INFO_S</span><span class="w"> </span><span class="n">stCropCfg</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VDEC_ATTR_JPEG_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">enRotation</td>
<td align="center">指定旋转角度，包括0，90，180，270</td>
</tr>
<tr>
<td align="center">enMirrorFlip;</td>
<td align="center">指定镜像模式</td>
</tr>
<tr>
<td align="center">stCropCfg</td>
<td align="center">指定解码区域</td>
</tr>
</tbody>
</table></section>
<section id="vdec-chn-attr-s">
<h3><span class="section-number">5.9.4.8. </span>VDEC_CHN_ATTR_S<a class="headerlink" href="#vdec-chn-attr-s" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义解码通道属性。</p>
</div></blockquote>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span>typedef struct HB_VDEC_CHN_ATTR_S {
    PAYLOAD_TYPE_E enType;
    VIDEO_MODE_E enMode;
    PIXEL_FORMAT_E enPixelFormat;
    uint32_t u32StreamBufSize;
    uint32_t u32StreamBufCnt;
    HB_BOOL bExternalBitStreamBuf；
    uint32_t u32FrameBufCnt;
    uint32_t vlc_buf_size;
    union {
        VDEC_ATTR_H264_S stAttrH264;
        VDEC_ATTR_H265_S stAttrH265;
        VDEC_ATTR_MJPEG_S stAttrMjpeg;
        VDEC_ATTR_JPEG_S stAttrJpeg;
    };
} VDEC_CHN_ATTR_S;
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">enType</td>
<td align="center">码流类型，例如是H264还是H265等等</td>
</tr>
<tr>
<td align="center">enMode</td>
<td align="center">解码模式，只支持帧模式</td>
</tr>
<tr>
<td align="center">enPixelFormat</td>
<td align="center">解码输出像素格式</td>
</tr>
<tr>
<td align="center">u32StreamBufSize</td>
<td align="center">用于解码输入的stream流buffer大小</td>
</tr>
<tr>
<td align="center">u32StreamBufCnt</td>
<td align="center">用于解码输入的strema流buffer数量</td>
</tr>
<tr>
<td align="center">bExternalBitStreamBuf</td>
<td align="center">Stream流使用外部还是内部buffer进行解码</td>
</tr>
<tr>
<td align="center">u32FrameBufCnt</td>
<td align="center">用于解码输出的frame buffer数量</td>
</tr>
<tr>
<td align="center">vlc_buf_size</td>
<td align="center">解码器vlc buffer大小</td>
</tr>
<tr>
<td align="center">stAttrH264/stAttrH265<br/>stAttrMjpeg/stAttrJpeg</td>
<td align="center">种协议的编码器属性</td>
</tr>
</tbody>
</table></section>
<section id="hb-vdec-userdata-s">
<h3><span class="section-number">5.9.4.9. </span>HB_VDEC_USERDATA_S<a class="headerlink" href="#hb-vdec-userdata-s" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义解码用户数据结构体。</p>
</div></blockquote>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VDEC_USERDATA_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">HB_BOOL</span><span class="w">  </span><span class="n">bValid</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">   </span><span class="n">u32Len</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint64_t</span><span class="w">   </span><span class="n">u64PhyAddr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w">   </span><span class="n">pu8Addr</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VDEC_USERDATA_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">bValid</td>
<td align="center">是否使能</td>
</tr>
<tr>
<td align="center">u32Len</td>
<td align="center">用户数据长度</td>
</tr>
<tr>
<td align="center">u64PhyAddr</td>
<td align="center">用户数据物理地址</td>
</tr>
<tr>
<td align="center">pu8Addr</td>
<td align="center">用户数据虚拟地址</td>
</tr>
</tbody>
</table></section>
<section id="hb-vdec-chn-status-s">
<h3><span class="section-number">5.9.4.10. </span>HB_VDEC_CHN_STATUS_S<a class="headerlink" href="#hb-vdec-chn-status-s" title="永久链接至标题"></a></h3>
<p>【描述】</p>
<blockquote>
<div><p>定义解码通道状态结构体。</p>
</div></blockquote>
<p>【结构定义】</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HB_VDEC_CHN_STATUS_S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">cur_input_buf_cnt</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">cur_input_buf_size</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">cur_output_buf_cnt</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">cur_output_buf_size</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">left_recv_frame</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">left_enc_frame</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">total_input_buf_cnt</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">total_output_buf_cnt</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">int32_t</span><span class="w"> </span><span class="n">pipeline</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">int32_t</span><span class="w"> </span><span class="n">channel_port_id</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">VDEC_CHN_STATUS_S</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>【成员说明】</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">成员</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">cur_input_buf_cnt</td>
<td align="center">当前输入未解码码流个数</td>
</tr>
<tr>
<td align="center">cur_input_buf_size</td>
<td align="center">当前输入码流buffer size</td>
</tr>
<tr>
<td align="center">cur_output_buf_cnt</td>
<td align="center">当前已完成解码码流个数</td>
</tr>
<tr>
<td align="center">cur_output_buf_size</td>
<td align="center">当前已解码码流buffer size</td>
</tr>
<tr>
<td align="center">left_recv_frame</td>
<td align="center">剩余需要接收帧数</td>
</tr>
<tr>
<td align="center">left_enc_frame</td>
<td align="center">剩余需要编码帧数</td>
</tr>
<tr>
<td align="center">total_input_buf_cnt</td>
<td align="center">总计输入码流个数</td>
</tr>
<tr>
<td align="center">total_output_buf_cnt</td>
<td align="center">总计解码个数</td>
</tr>
<tr>
<td align="center">pipeline</td>
<td align="center">pipeline</td>
</tr>
<tr>
<td align="center">channel_port_id</td>
<td align="center">channel id</td>
</tr>
</tbody>
</table></section>
</section>
<section id="id11">
<h2><span class="section-number">5.9.5. </span>错误码<a class="headerlink" href="#id11" title="永久链接至标题"></a></h2>
<p>VDEC 错误码如下表：</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">错误码</th>
<th align="left">宏定义</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-269024256</td>
<td align="left">HB_ERR_VDEC_UNKNOWN</td>
<td align="left">未知错误</td>
</tr>
<tr>
<td align="center">-269024257</td>
<td align="left">HB_ERR_VDEC_NOT_FOUND</td>
<td align="left">VDEC通道未找到</td>
</tr>
<tr>
<td align="center">-269024258</td>
<td align="left">HB_ERR_VDEC_OPEN_FAIL</td>
<td align="left">打开VDEC通道识别</td>
</tr>
<tr>
<td align="center">-269024259</td>
<td align="left">HB_ERR_VDEC_RESPONSE_TIMEOUT</td>
<td align="left">操作VDEC通道无响应</td>
</tr>
<tr>
<td align="center">-269024260</td>
<td align="left">HB_ERR_VDEC_INIT_FAIL</td>
<td align="left">初始化VDEC模块失败</td>
</tr>
<tr>
<td align="center">-269024261</td>
<td align="left">HB_ERR_VDEC_OPERATION_NOT_ALLOWDED</td>
<td align="left">操作不允许</td>
</tr>
<tr>
<td align="center">-269024262</td>
<td align="left">HB_ERR_VDEC_NOMEM</td>
<td align="left">VDEC内存不够</td>
</tr>
<tr>
<td align="center">-269024263</td>
<td align="left">HB_ERR_VDEC_NO_FREE_CHANNEL</td>
<td align="left">没有空的VDEC通道</td>
</tr>
<tr>
<td align="center">-269024264</td>
<td align="left">HB_ERR_VDEC_ILLEGAL_PARAM</td>
<td align="left">参数错误</td>
</tr>
<tr>
<td align="center">-269024265</td>
<td align="left">HB_ERR_VDEC_INVALID_CHNID</td>
<td align="left">错误的通道号</td>
</tr>
<tr>
<td align="center">-269024266</td>
<td align="left">HB_ERR_VDEC_INVALID_BUF</td>
<td align="left">错误的buffer块</td>
</tr>
<tr>
<td align="center">-269024267</td>
<td align="left">HB_ERR_VDEC_INVALID_CMD</td>
<td align="left">错误的命令</td>
</tr>
<tr>
<td align="center">-269024268</td>
<td align="left">HB_ERR_VDEC_WAIT_TIMEOUT</td>
<td align="left">等待超时</td>
</tr>
<tr>
<td align="center">-269024269</td>
<td align="left">HB_ERR_VDEC_FILE_OPERATION_FAIL</td>
<td align="left">操作失败</td>
</tr>
<tr>
<td align="center">-269024270</td>
<td align="left">HB_ERR_VDEC_PARAMS_SET_FAIL</td>
<td align="left">设置参数失败</td>
</tr>
<tr>
<td align="center">-269024271</td>
<td align="left">HB_ERR_VDEC_PARAMS_GET_FAIL</td>
<td align="left">获取参数失败</td>
</tr>
<tr>
<td align="center">-269024272</td>
<td align="left">HB_ERR_VDEC_EXIST</td>
<td align="left">VDEC 通道已存在</td>
</tr>
<tr>
<td align="center">-269024273</td>
<td align="left">HB_ERR_VDEC_UNEXIST</td>
<td align="left">VDEC通道不存在</td>
</tr>
<tr>
<td align="center">-269024274</td>
<td align="left">HB_ERR_VDEC_NULL_PTR</td>
<td align="left">空指针</td>
</tr>
</tbody>
</table></section>
<section id="id12">
<h2><span class="section-number">5.9.6. </span>参考代码<a class="headerlink" href="#id12" title="永久链接至标题"></a></h2>
<p>VDEC部分示例代码可以参考，<a class="reference external" href="../samples/Mpp_Usage_Guidelines/sample_video_codec.html">sample_video_codec</a>。</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="8-Video_Encode_zh_CN.html" class="btn btn-neutral float-left" title="5.8. 视频编码" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="10-ISP_Tuning_Guide/index.html" class="btn btn-neutral float-right" title="5.10. 图像调试指南" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, Horizon Robotics.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>